\doxysection{Jacobi\+SVD.\+h}
\hypertarget{_jacobi_s_v_d_8h_source}{}\label{_jacobi_s_v_d_8h_source}\index{packages/Eigen.3.3.3/build/native/include/Eigen/src/SVD/JacobiSVD.h@{packages/Eigen.3.3.3/build/native/include/Eigen/src/SVD/JacobiSVD.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2009-\/2010\ Benoit\ Jacob\ <jacob.benoit.1@gmail.com>}}
\DoxyCodeLine{00005\ \textcolor{comment}{//\ Copyright\ (C)\ 2013-\/2014\ Gael\ Guennebaud\ <gael.guennebaud@inria.fr>}}
\DoxyCodeLine{00006\ \textcolor{comment}{//}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00009\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00010\ }
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_JACOBISVD\_H}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#define\ EIGEN\_JACOBISVD\_H}}
\DoxyCodeLine{00013\ }
\DoxyCodeLine{00014\ \textcolor{keyword}{namespace\ }Eigen\ \{\ }
\DoxyCodeLine{00015\ }
\DoxyCodeLine{00016\ \textcolor{keyword}{namespace\ }internal\ \{}
\DoxyCodeLine{00017\ \textcolor{comment}{//\ forward\ declaration\ (needed\ by\ ICC)}}
\DoxyCodeLine{00018\ \textcolor{comment}{//\ the\ empty\ body\ is\ required\ by\ MSVC}}
\DoxyCodeLine{00019\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner,}
\DoxyCodeLine{00020\ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ IsComplex\ =\ NumTraits<typename\ MatrixType::Scalar>::IsComplex>}
\DoxyCodeLine{00021\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{svd\_precondition\_2x2\_block\_to\_be\_real}}\ \{\};}
\DoxyCodeLine{00022\ }
\DoxyCodeLine{00023\ \textcolor{comment}{/***\ QR\ preconditioners\ (R-\/SVD)}}
\DoxyCodeLine{00024\ \textcolor{comment}{\ ***}}
\DoxyCodeLine{00025\ \textcolor{comment}{\ ***\ Their\ role\ is\ to\ reduce\ the\ problem\ of\ computing\ the\ SVD\ to\ the\ case\ of\ a\ square\ matrix.}}
\DoxyCodeLine{00026\ \textcolor{comment}{\ ***\ This\ approach,\ known\ as\ R-\/SVD,\ is\ an\ optimization\ for\ rectangular-\/enough\ matrices,\ and\ is\ a\ requirement\ for}}
\DoxyCodeLine{00027\ \textcolor{comment}{\ ***\ JacobiSVD\ which\ by\ itself\ is\ only\ able\ to\ work\ on\ square\ matrices.}}
\DoxyCodeLine{00028\ \textcolor{comment}{\ ***/}}
\DoxyCodeLine{00029\ }
\DoxyCodeLine{00030\ \textcolor{keyword}{enum}\ \{\ PreconditionIfMoreColsThanRows,\ PreconditionIfMoreRowsThanCols\ \};}
\DoxyCodeLine{00031\ }
\DoxyCodeLine{00032\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner,\ \textcolor{keywordtype}{int}\ Case>}
\DoxyCodeLine{00033\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__should__do__anything}{qr\_preconditioner\_should\_do\_anything}}}
\DoxyCodeLine{00034\ \{}
\DoxyCodeLine{00035\ \ \ \textcolor{keyword}{enum}\ \{\ a\ =\ MatrixType::RowsAtCompileTime\ !=\ Dynamic\ \&\&}
\DoxyCodeLine{00036\ \ \ \ \ \ \ \ \ \ \ \ \ \ MatrixType::ColsAtCompileTime\ !=\ Dynamic\ \&\&}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \ \ \ \ \ \ \ MatrixType::ColsAtCompileTime\ <=\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00038\ \ \ \ \ \ \ \ \ \ b\ =\ MatrixType::RowsAtCompileTime\ !=\ Dynamic\ \&\&}
\DoxyCodeLine{00039\ \ \ \ \ \ \ \ \ \ \ \ \ \ MatrixType::ColsAtCompileTime\ !=\ Dynamic\ \&\&}
\DoxyCodeLine{00040\ \ \ \ \ \ \ \ \ \ \ \ \ \ MatrixType::RowsAtCompileTime\ <=\ MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{00041\ \ \ \ \ \ \ \ \ \ ret\ =\ !(\ (QRPreconditioner\ ==\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56ea2e95bc818f975b19def01e93d240dece}{NoQRPreconditioner}})\ ||}
\DoxyCodeLine{00042\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (Case\ ==\ PreconditionIfMoreColsThanRows\ \&\&\ \textcolor{keywordtype}{bool}(a))\ ||}
\DoxyCodeLine{00043\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (Case\ ==\ PreconditionIfMoreRowsThanCols\ \&\&\ \textcolor{keywordtype}{bool}(b))\ )}
\DoxyCodeLine{00044\ \ \ \};}
\DoxyCodeLine{00045\ \};}
\DoxyCodeLine{00046\ }
\DoxyCodeLine{00047\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner,\ \textcolor{keywordtype}{int}\ Case,}
\DoxyCodeLine{00048\ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ DoAnything\ =\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__should__do__anything}{qr\_preconditioner\_should\_do\_anything<MatrixType,\ QRPreconditioner,\ Case>::ret}}}
\DoxyCodeLine{00049\ >\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}\ \{\};}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner,\ \textcolor{keywordtype}{int}\ Case>}
\DoxyCodeLine{00052\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<MatrixType,\ QRPreconditioner,\ Case,\ false>}
\DoxyCodeLine{00053\ \{}
\DoxyCodeLine{00054\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00055\ \ \ \textcolor{keywordtype}{void}\ allocate(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ QRPreconditioner>}}\&)\ \{\}}
\DoxyCodeLine{00056\ \ \ \textcolor{keywordtype}{bool}\ run(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ QRPreconditioner>}}\&,\ \textcolor{keyword}{const}\ MatrixType\&)}
\DoxyCodeLine{00057\ \ \ \{}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00059\ \ \ \}}
\DoxyCodeLine{00060\ \};}
\DoxyCodeLine{00061\ }
\DoxyCodeLine{00062\ \textcolor{comment}{/***\ preconditioner\ using\ FullPivHouseholderQR\ ***/}}
\DoxyCodeLine{00063\ }
\DoxyCodeLine{00064\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00065\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<MatrixType,\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd745dcaff7019c5f918c68809e5ea50}{FullPivHouseholderQRPreconditioner}},\ PreconditionIfMoreRowsThanCols,\ true>}
\DoxyCodeLine{00066\ \{}
\DoxyCodeLine{00067\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00068\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ Scalar;}
\DoxyCodeLine{00069\ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00070\ \ \ \{}
\DoxyCodeLine{00071\ \ \ \ \ RowsAtCompileTime\ =\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00072\ \ \ \ \ MaxRowsAtCompileTime\ =\ MatrixType::MaxRowsAtCompileTime}
\DoxyCodeLine{00073\ \ \ \};}
\DoxyCodeLine{00074\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,\ 1,\ RowsAtCompileTime,\ RowMajor,\ 1,\ MaxRowsAtCompileTime>}}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{WorkspaceType}};}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00076\ \ \ \textcolor{keywordtype}{void}\ allocate(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ FullPivHouseholderQRPreconditioner>}}\&\ svd)}
\DoxyCodeLine{00077\ \ \ \{}
\DoxyCodeLine{00078\ \ \ \ \ \textcolor{keywordflow}{if}\ (svd.rows()\ !=\ m\_qr.rows()\ ||\ svd.cols()\ !=\ m\_qr.cols())}
\DoxyCodeLine{00079\ \ \ \ \ \{}
\DoxyCodeLine{00080\ \ \ \ \ \ \ m\_qr.\string~QRType();}
\DoxyCodeLine{00081\ \ \ \ \ \ \ ::new\ (\&m\_qr)\ \mbox{\hyperlink{class_eigen_1_1_full_piv_householder_q_r}{QRType}}(svd.rows(),\ svd.cols());}
\DoxyCodeLine{00082\ \ \ \ \ \}}
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keywordflow}{if}\ (svd.m\_computeFullU)\ m\_workspace.resize(svd.rows());}
\DoxyCodeLine{00084\ \ \ \}}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00086\ \ \ \textcolor{keywordtype}{bool}\ run(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ FullPivHouseholderQRPreconditioner>}}\&\ svd,\ \textcolor{keyword}{const}\ MatrixType\&\ matrix)}
\DoxyCodeLine{00087\ \ \ \{}
\DoxyCodeLine{00088\ \ \ \ \ \textcolor{keywordflow}{if}(matrix.rows()\ >\ matrix.cols())}
\DoxyCodeLine{00089\ \ \ \ \ \{}
\DoxyCodeLine{00090\ \ \ \ \ \ \ m\_qr.compute(matrix);}
\DoxyCodeLine{00091\ \ \ \ \ \ \ svd.m\_workMatrix\ =\ m\_qr.matrixQR().block(0,0,matrix.cols(),matrix.cols()).template\ triangularView<Upper>();}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.m\_computeFullU)\ m\_qr.matrixQ().evalTo(svd.m\_matrixU,\ m\_workspace);}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5f12efcb791eb007d4a4890ac5255ac4}{computeV}}())\ svd.m\_matrixV\ =\ m\_qr.colsPermutation();}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00095\ \ \ \ \ \}}
\DoxyCodeLine{00096\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00097\ \ \ \}}
\DoxyCodeLine{00098\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00099\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_full_piv_householder_q_r}{FullPivHouseholderQR<MatrixType>}}\ \mbox{\hyperlink{class_eigen_1_1_full_piv_householder_q_r}{QRType}};}
\DoxyCodeLine{00100\ \ \ \mbox{\hyperlink{class_eigen_1_1_full_piv_householder_q_r}{QRType}}\ m\_qr;}
\DoxyCodeLine{00101\ \ \ \mbox{\hyperlink{class_eigen_1_1_matrix}{WorkspaceType}}\ m\_workspace;}
\DoxyCodeLine{00102\ \};}
\DoxyCodeLine{00103\ }
\DoxyCodeLine{00104\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00105\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<MatrixType,\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd745dcaff7019c5f918c68809e5ea50}{FullPivHouseholderQRPreconditioner}},\ PreconditionIfMoreColsThanRows,\ true>}
\DoxyCodeLine{00106\ \{}
\DoxyCodeLine{00107\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00108\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ Scalar;}
\DoxyCodeLine{00109\ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00110\ \ \ \{}
\DoxyCodeLine{00111\ \ \ \ \ RowsAtCompileTime\ =\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00112\ \ \ \ \ ColsAtCompileTime\ =\ MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{00113\ \ \ \ \ MaxRowsAtCompileTime\ =\ MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{00114\ \ \ \ \ MaxColsAtCompileTime\ =\ MatrixType::MaxColsAtCompileTime,}
\DoxyCodeLine{00115\ \ \ \ \ TrOptions\ =\ RowsAtCompileTime==1\ ?\ (MatrixType::Options\ \&\ \string~(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}}))}
\DoxyCodeLine{00116\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ColsAtCompileTime==1\ ?\ (MatrixType::Options\ |\ \ \ \mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}})}
\DoxyCodeLine{00117\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ MatrixType::Options}
\DoxyCodeLine{00118\ \ \ \};}
\DoxyCodeLine{00119\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,\ ColsAtCompileTime,\ RowsAtCompileTime,\ TrOptions,\ MaxColsAtCompileTime,\ MaxRowsAtCompileTime>}}}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_matrix}{TransposeTypeWithSameStorageOrder}};}
\DoxyCodeLine{00121\ }
\DoxyCodeLine{00122\ \ \ \textcolor{keywordtype}{void}\ allocate(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ FullPivHouseholderQRPreconditioner>}}\&\ svd)}
\DoxyCodeLine{00123\ \ \ \{}
\DoxyCodeLine{00124\ \ \ \ \ \textcolor{keywordflow}{if}\ (svd.cols()\ !=\ m\_qr.rows()\ ||\ svd.rows()\ !=\ m\_qr.cols())}
\DoxyCodeLine{00125\ \ \ \ \ \{}
\DoxyCodeLine{00126\ \ \ \ \ \ \ m\_qr.\string~QRType();}
\DoxyCodeLine{00127\ \ \ \ \ \ \ ::new\ (\&m\_qr)\ \mbox{\hyperlink{class_eigen_1_1_full_piv_householder_q_r}{QRType}}(svd.cols(),\ svd.rows());}
\DoxyCodeLine{00128\ \ \ \ \ \}}
\DoxyCodeLine{00129\ \ \ \ \ m\_adjoint.resize(svd.cols(),\ svd.rows());}
\DoxyCodeLine{00130\ \ \ \ \ \textcolor{keywordflow}{if}\ (svd.m\_computeFullV)\ m\_workspace.resize(svd.cols());}
\DoxyCodeLine{00131\ \ \ \}}
\DoxyCodeLine{00132\ }
\DoxyCodeLine{00133\ \ \ \textcolor{keywordtype}{bool}\ run(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ FullPivHouseholderQRPreconditioner>}}\&\ svd,\ \textcolor{keyword}{const}\ MatrixType\&\ matrix)}
\DoxyCodeLine{00134\ \ \ \{}
\DoxyCodeLine{00135\ \ \ \ \ \textcolor{keywordflow}{if}(matrix.cols()\ >\ matrix.rows())}
\DoxyCodeLine{00136\ \ \ \ \ \{}
\DoxyCodeLine{00137\ \ \ \ \ \ \ m\_adjoint\ =\ matrix.adjoint();}
\DoxyCodeLine{00138\ \ \ \ \ \ \ m\_qr.compute(m\_adjoint);}
\DoxyCodeLine{00139\ \ \ \ \ \ \ svd.m\_workMatrix\ =\ m\_qr.matrixQR().block(0,0,matrix.rows(),matrix.rows()).template\ triangularView<Upper>().adjoint();}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.m\_computeFullV)\ m\_qr.matrixQ().evalTo(svd.m\_matrixV,\ m\_workspace);}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a705a7c2709e1624ccc19aa748a78d473}{computeU}}())\ svd.m\_matrixU\ =\ m\_qr.colsPermutation();}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00143\ \ \ \ \ \}}
\DoxyCodeLine{00144\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00145\ \ \ \}}
\DoxyCodeLine{00146\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00147\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_full_piv_householder_q_r}{FullPivHouseholderQR<TransposeTypeWithSameStorageOrder>}}\ \mbox{\hyperlink{class_eigen_1_1_full_piv_householder_q_r}{QRType}};}
\DoxyCodeLine{00148\ \ \ \mbox{\hyperlink{class_eigen_1_1_full_piv_householder_q_r}{QRType}}\ m\_qr;}
\DoxyCodeLine{00149\ \ \ \mbox{\hyperlink{class_eigen_1_1_matrix}{TransposeTypeWithSameStorageOrder}}\ m\_adjoint;}
\DoxyCodeLine{00150\ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1true__type}{internal::plain\_row\_type<MatrixType>::type}}\ m\_workspace;}
\DoxyCodeLine{00151\ \};}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \textcolor{comment}{/***\ preconditioner\ using\ ColPivHouseholderQR\ ***/}}
\DoxyCodeLine{00154\ }
\DoxyCodeLine{00155\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00156\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<MatrixType,\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd2e2f4875c5b4b6e602a433d90c4e5e}{ColPivHouseholderQRPreconditioner}},\ PreconditionIfMoreRowsThanCols,\ true>}
\DoxyCodeLine{00157\ \{}
\DoxyCodeLine{00158\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00159\ \ \ \textcolor{keywordtype}{void}\ allocate(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ ColPivHouseholderQRPreconditioner>}}\&\ svd)}
\DoxyCodeLine{00160\ \ \ \{}
\DoxyCodeLine{00161\ \ \ \ \ \textcolor{keywordflow}{if}\ (svd.rows()\ !=\ m\_qr.rows()\ ||\ svd.cols()\ !=\ m\_qr.cols())}
\DoxyCodeLine{00162\ \ \ \ \ \{}
\DoxyCodeLine{00163\ \ \ \ \ \ \ m\_qr.\string~QRType();}
\DoxyCodeLine{00164\ \ \ \ \ \ \ ::new\ (\&m\_qr)\ \mbox{\hyperlink{class_eigen_1_1_col_piv_householder_q_r}{QRType}}(svd.rows(),\ svd.cols());}
\DoxyCodeLine{00165\ \ \ \ \ \}}
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keywordflow}{if}\ (svd.m\_computeFullU)\ m\_workspace.resize(svd.rows());}
\DoxyCodeLine{00167\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (svd.m\_computeThinU)\ m\_workspace.resize(svd.cols());}
\DoxyCodeLine{00168\ \ \ \}}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ \ \ \textcolor{keywordtype}{bool}\ run(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ ColPivHouseholderQRPreconditioner>}}\&\ svd,\ \textcolor{keyword}{const}\ MatrixType\&\ matrix)}
\DoxyCodeLine{00171\ \ \ \{}
\DoxyCodeLine{00172\ \ \ \ \ \textcolor{keywordflow}{if}(matrix.rows()\ >\ matrix.cols())}
\DoxyCodeLine{00173\ \ \ \ \ \{}
\DoxyCodeLine{00174\ \ \ \ \ \ \ m\_qr.compute(matrix);}
\DoxyCodeLine{00175\ \ \ \ \ \ \ svd.m\_workMatrix\ =\ m\_qr.matrixQR().block(0,0,matrix.cols(),matrix.cols()).template\ triangularView<Upper>();}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.m\_computeFullU)\ m\_qr.householderQ().evalTo(svd.m\_matrixU,\ m\_workspace);}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(svd.m\_computeThinU)}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ svd.m\_matrixU.setIdentity(matrix.rows(),\ matrix.cols());}
\DoxyCodeLine{00180\ \ \ \ \ \ \ \ \ m\_qr.householderQ().applyThisOnTheLeft(svd.m\_matrixU,\ m\_workspace);}
\DoxyCodeLine{00181\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00182\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5f12efcb791eb007d4a4890ac5255ac4}{computeV}}())\ svd.m\_matrixV\ =\ m\_qr.colsPermutation();}
\DoxyCodeLine{00183\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00184\ \ \ \ \ \}}
\DoxyCodeLine{00185\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00186\ \ \ \}}
\DoxyCodeLine{00187\ }
\DoxyCodeLine{00188\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00189\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR<MatrixType>}}\ \mbox{\hyperlink{class_eigen_1_1_col_piv_householder_q_r}{QRType}};}
\DoxyCodeLine{00190\ \ \ \mbox{\hyperlink{class_eigen_1_1_col_piv_householder_q_r}{QRType}}\ m\_qr;}
\DoxyCodeLine{00191\ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1true__type}{internal::plain\_col\_type<MatrixType>::type}}\ m\_workspace;}
\DoxyCodeLine{00192\ \};}
\DoxyCodeLine{00193\ }
\DoxyCodeLine{00194\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00195\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<MatrixType,\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd2e2f4875c5b4b6e602a433d90c4e5e}{ColPivHouseholderQRPreconditioner}},\ PreconditionIfMoreColsThanRows,\ true>}
\DoxyCodeLine{00196\ \{}
\DoxyCodeLine{00197\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00198\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ Scalar;}
\DoxyCodeLine{00199\ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00200\ \ \ \{}
\DoxyCodeLine{00201\ \ \ \ \ RowsAtCompileTime\ =\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00202\ \ \ \ \ ColsAtCompileTime\ =\ MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{00203\ \ \ \ \ MaxRowsAtCompileTime\ =\ MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{00204\ \ \ \ \ MaxColsAtCompileTime\ =\ MatrixType::MaxColsAtCompileTime,}
\DoxyCodeLine{00205\ \ \ \ \ TrOptions\ =\ RowsAtCompileTime==1\ ?\ (MatrixType::Options\ \&\ \string~(\mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}}))}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ ColsAtCompileTime==1\ ?\ (MatrixType::Options\ |\ \ \ \mbox{\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a77c993a8d9f6efe5c1159fb2ab07dd4f}{RowMajor}})}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ MatrixType::Options}
\DoxyCodeLine{00208\ \ \ \};}
\DoxyCodeLine{00209\ }
\DoxyCodeLine{00210\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,\ ColsAtCompileTime,\ RowsAtCompileTime,\ TrOptions,\ MaxColsAtCompileTime,\ MaxRowsAtCompileTime>}}}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_matrix}{TransposeTypeWithSameStorageOrder}};}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \textcolor{keywordtype}{void}\ allocate(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ ColPivHouseholderQRPreconditioner>}}\&\ svd)}
\DoxyCodeLine{00214\ \ \ \{}
\DoxyCodeLine{00215\ \ \ \ \ \textcolor{keywordflow}{if}\ (svd.cols()\ !=\ m\_qr.rows()\ ||\ svd.rows()\ !=\ m\_qr.cols())}
\DoxyCodeLine{00216\ \ \ \ \ \{}
\DoxyCodeLine{00217\ \ \ \ \ \ \ m\_qr.\string~QRType();}
\DoxyCodeLine{00218\ \ \ \ \ \ \ ::new\ (\&m\_qr)\ \mbox{\hyperlink{class_eigen_1_1_col_piv_householder_q_r}{QRType}}(svd.cols(),\ svd.rows());}
\DoxyCodeLine{00219\ \ \ \ \ \}}
\DoxyCodeLine{00220\ \ \ \ \ \textcolor{keywordflow}{if}\ (svd.m\_computeFullV)\ m\_workspace.resize(svd.cols());}
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (svd.m\_computeThinV)\ m\_workspace.resize(svd.rows());}
\DoxyCodeLine{00222\ \ \ \ \ m\_adjoint.resize(svd.cols(),\ svd.rows());}
\DoxyCodeLine{00223\ \ \ \}}
\DoxyCodeLine{00224\ }
\DoxyCodeLine{00225\ \ \ \textcolor{keywordtype}{bool}\ run(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ ColPivHouseholderQRPreconditioner>}}\&\ svd,\ \textcolor{keyword}{const}\ MatrixType\&\ matrix)}
\DoxyCodeLine{00226\ \ \ \{}
\DoxyCodeLine{00227\ \ \ \ \ \textcolor{keywordflow}{if}(matrix.cols()\ >\ matrix.rows())}
\DoxyCodeLine{00228\ \ \ \ \ \{}
\DoxyCodeLine{00229\ \ \ \ \ \ \ m\_adjoint\ =\ matrix.adjoint();}
\DoxyCodeLine{00230\ \ \ \ \ \ \ m\_qr.compute(m\_adjoint);}
\DoxyCodeLine{00231\ }
\DoxyCodeLine{00232\ \ \ \ \ \ \ svd.m\_workMatrix\ =\ m\_qr.matrixQR().block(0,0,matrix.rows(),matrix.rows()).template\ triangularView<Upper>().adjoint();}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.m\_computeFullV)\ m\_qr.householderQ().evalTo(svd.m\_matrixV,\ m\_workspace);}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(svd.m\_computeThinV)}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ svd.m\_matrixV.setIdentity(matrix.cols(),\ matrix.rows());}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ m\_qr.householderQ().applyThisOnTheLeft(svd.m\_matrixV,\ m\_workspace);}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a705a7c2709e1624ccc19aa748a78d473}{computeU}}())\ svd.m\_matrixU\ =\ m\_qr.colsPermutation();}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00241\ \ \ \ \ \}}
\DoxyCodeLine{00242\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00243\ \ \ \}}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00246\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR<TransposeTypeWithSameStorageOrder>}}\ \mbox{\hyperlink{class_eigen_1_1_col_piv_householder_q_r}{QRType}};}
\DoxyCodeLine{00247\ \ \ \mbox{\hyperlink{class_eigen_1_1_col_piv_householder_q_r}{QRType}}\ m\_qr;}
\DoxyCodeLine{00248\ \ \ \mbox{\hyperlink{class_eigen_1_1_matrix}{TransposeTypeWithSameStorageOrder}}\ m\_adjoint;}
\DoxyCodeLine{00249\ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1true__type}{internal::plain\_row\_type<MatrixType>::type}}\ m\_workspace;}
\DoxyCodeLine{00250\ \};}
\DoxyCodeLine{00251\ }
\DoxyCodeLine{00252\ \textcolor{comment}{/***\ preconditioner\ using\ HouseholderQR\ ***/}}
\DoxyCodeLine{00253\ }
\DoxyCodeLine{00254\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00255\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<MatrixType,\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56ea9c660eb3336bf8c77ce9d081ca07cbdd}{HouseholderQRPreconditioner}},\ PreconditionIfMoreRowsThanCols,\ true>}
\DoxyCodeLine{00256\ \{}
\DoxyCodeLine{00257\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00258\ \ \ \textcolor{keywordtype}{void}\ allocate(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ HouseholderQRPreconditioner>}}\&\ svd)}
\DoxyCodeLine{00259\ \ \ \{}
\DoxyCodeLine{00260\ \ \ \ \ \textcolor{keywordflow}{if}\ (svd.rows()\ !=\ m\_qr.rows()\ ||\ svd.cols()\ !=\ m\_qr.cols())}
\DoxyCodeLine{00261\ \ \ \ \ \{}
\DoxyCodeLine{00262\ \ \ \ \ \ \ m\_qr.\string~QRType();}
\DoxyCodeLine{00263\ \ \ \ \ \ \ ::new\ (\&m\_qr)\ \mbox{\hyperlink{class_eigen_1_1_householder_q_r}{QRType}}(svd.rows(),\ svd.cols());}
\DoxyCodeLine{00264\ \ \ \ \ \}}
\DoxyCodeLine{00265\ \ \ \ \ \textcolor{keywordflow}{if}\ (svd.m\_computeFullU)\ m\_workspace.resize(svd.rows());}
\DoxyCodeLine{00266\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (svd.m\_computeThinU)\ m\_workspace.resize(svd.cols());}
\DoxyCodeLine{00267\ \ \ \}}
\DoxyCodeLine{00268\ }
\DoxyCodeLine{00269\ \ \ \textcolor{keywordtype}{bool}\ run(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ HouseholderQRPreconditioner>}}\&\ svd,\ \textcolor{keyword}{const}\ MatrixType\&\ matrix)}
\DoxyCodeLine{00270\ \ \ \{}
\DoxyCodeLine{00271\ \ \ \ \ \textcolor{keywordflow}{if}(matrix.rows()\ >\ matrix.cols())}
\DoxyCodeLine{00272\ \ \ \ \ \{}
\DoxyCodeLine{00273\ \ \ \ \ \ \ m\_qr.compute(matrix);}
\DoxyCodeLine{00274\ \ \ \ \ \ \ svd.m\_workMatrix\ =\ m\_qr.matrixQR().block(0,0,matrix.cols(),matrix.cols()).template\ triangularView<Upper>();}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.m\_computeFullU)\ m\_qr.householderQ().evalTo(svd.m\_matrixU,\ m\_workspace);}
\DoxyCodeLine{00276\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(svd.m\_computeThinU)}
\DoxyCodeLine{00277\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00278\ \ \ \ \ \ \ \ \ svd.m\_matrixU.setIdentity(matrix.rows(),\ matrix.cols());}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ m\_qr.householderQ().applyThisOnTheLeft(svd.m\_matrixU,\ m\_workspace);}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5f12efcb791eb007d4a4890ac5255ac4}{computeV}}())\ svd.m\_matrixV.setIdentity(matrix.cols(),\ matrix.cols());}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00283\ \ \ \ \ \}}
\DoxyCodeLine{00284\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00285\ \ \ \}}
\DoxyCodeLine{00286\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00287\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_householder_q_r}{HouseholderQR<MatrixType>}}\ \mbox{\hyperlink{class_eigen_1_1_householder_q_r}{QRType}};}
\DoxyCodeLine{00288\ \ \ \mbox{\hyperlink{class_eigen_1_1_householder_q_r}{QRType}}\ m\_qr;}
\DoxyCodeLine{00289\ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1true__type}{internal::plain\_col\_type<MatrixType>::type}}\ m\_workspace;}
\DoxyCodeLine{00290\ \};}
\DoxyCodeLine{00291\ }
\DoxyCodeLine{00292\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00293\ \textcolor{keyword}{class\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{qr\_preconditioner\_impl}}<MatrixType,\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56ea9c660eb3336bf8c77ce9d081ca07cbdd}{HouseholderQRPreconditioner}},\ PreconditionIfMoreColsThanRows,\ true>}
\DoxyCodeLine{00294\ \{}
\DoxyCodeLine{00295\ \textcolor{keyword}{public}:}
\DoxyCodeLine{00296\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ Scalar;}
\DoxyCodeLine{00297\ \ \ \textcolor{keyword}{enum}}
\DoxyCodeLine{00298\ \ \ \{}
\DoxyCodeLine{00299\ \ \ \ \ RowsAtCompileTime\ =\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00300\ \ \ \ \ ColsAtCompileTime\ =\ MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{00301\ \ \ \ \ MaxRowsAtCompileTime\ =\ MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{00302\ \ \ \ \ MaxColsAtCompileTime\ =\ MatrixType::MaxColsAtCompileTime,}
\DoxyCodeLine{00303\ \ \ \ \ Options\ =\ MatrixType::Options}
\DoxyCodeLine{00304\ \ \ \};}
\DoxyCodeLine{00305\ }
\DoxyCodeLine{00306\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,\ ColsAtCompileTime,\ RowsAtCompileTime,\ Options,\ MaxColsAtCompileTime,\ MaxRowsAtCompileTime>}}}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_matrix}{TransposeTypeWithSameStorageOrder}};}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00309\ \ \ \textcolor{keywordtype}{void}\ allocate(\textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ HouseholderQRPreconditioner>}}\&\ svd)}
\DoxyCodeLine{00310\ \ \ \{}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keywordflow}{if}\ (svd.cols()\ !=\ m\_qr.rows()\ ||\ svd.rows()\ !=\ m\_qr.cols())}
\DoxyCodeLine{00312\ \ \ \ \ \{}
\DoxyCodeLine{00313\ \ \ \ \ \ \ m\_qr.\string~QRType();}
\DoxyCodeLine{00314\ \ \ \ \ \ \ ::new\ (\&m\_qr)\ \mbox{\hyperlink{class_eigen_1_1_householder_q_r}{QRType}}(svd.cols(),\ svd.rows());}
\DoxyCodeLine{00315\ \ \ \ \ \}}
\DoxyCodeLine{00316\ \ \ \ \ \textcolor{keywordflow}{if}\ (svd.m\_computeFullV)\ m\_workspace.resize(svd.cols());}
\DoxyCodeLine{00317\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (svd.m\_computeThinV)\ m\_workspace.resize(svd.rows());}
\DoxyCodeLine{00318\ \ \ \ \ m\_adjoint.resize(svd.cols(),\ svd.rows());}
\DoxyCodeLine{00319\ \ \ \}}
\DoxyCodeLine{00320\ }
\DoxyCodeLine{00321\ \ \ \textcolor{keywordtype}{bool}\ run(\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ HouseholderQRPreconditioner>}}\&\ svd,\ \textcolor{keyword}{const}\ MatrixType\&\ matrix)}
\DoxyCodeLine{00322\ \ \ \{}
\DoxyCodeLine{00323\ \ \ \ \ \textcolor{keywordflow}{if}(matrix.cols()\ >\ matrix.rows())}
\DoxyCodeLine{00324\ \ \ \ \ \{}
\DoxyCodeLine{00325\ \ \ \ \ \ \ m\_adjoint\ =\ matrix.adjoint();}
\DoxyCodeLine{00326\ \ \ \ \ \ \ m\_qr.compute(m\_adjoint);}
\DoxyCodeLine{00327\ }
\DoxyCodeLine{00328\ \ \ \ \ \ \ svd.m\_workMatrix\ =\ m\_qr.matrixQR().block(0,0,matrix.rows(),matrix.rows()).template\ triangularView<Upper>().adjoint();}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.m\_computeFullV)\ m\_qr.householderQ().evalTo(svd.m\_matrixV,\ m\_workspace);}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}(svd.m\_computeThinV)}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ svd.m\_matrixV.setIdentity(matrix.cols(),\ matrix.rows());}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ m\_qr.householderQ().applyThisOnTheLeft(svd.m\_matrixV,\ m\_workspace);}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a705a7c2709e1624ccc19aa748a78d473}{computeU}}())\ svd.m\_matrixU.setIdentity(matrix.rows(),\ matrix.rows());}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};}
\DoxyCodeLine{00337\ \ \ \ \ \}}
\DoxyCodeLine{00338\ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{false};}
\DoxyCodeLine{00339\ \ \ \}}
\DoxyCodeLine{00340\ }
\DoxyCodeLine{00341\ \textcolor{keyword}{private}:}
\DoxyCodeLine{00342\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_householder_q_r}{HouseholderQR<TransposeTypeWithSameStorageOrder>}}\ \mbox{\hyperlink{class_eigen_1_1_householder_q_r}{QRType}};}
\DoxyCodeLine{00343\ \ \ \mbox{\hyperlink{class_eigen_1_1_householder_q_r}{QRType}}\ m\_qr;}
\DoxyCodeLine{00344\ \ \ \mbox{\hyperlink{class_eigen_1_1_matrix}{TransposeTypeWithSameStorageOrder}}\ m\_adjoint;}
\DoxyCodeLine{00345\ \ \ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1true__type}{internal::plain\_row\_type<MatrixType>::type}}\ m\_workspace;}
\DoxyCodeLine{00346\ \};}
\DoxyCodeLine{00347\ }
\DoxyCodeLine{00348\ \textcolor{comment}{/***\ 2x2\ SVD\ implementation}}
\DoxyCodeLine{00349\ \textcolor{comment}{\ ***}}
\DoxyCodeLine{00350\ \textcolor{comment}{\ ***\ JacobiSVD\ consists\ in\ performing\ a\ series\ of\ 2x2\ SVD\ subproblems}}
\DoxyCodeLine{00351\ \textcolor{comment}{\ ***/}}
\DoxyCodeLine{00352\ }
\DoxyCodeLine{00353\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner>}
\DoxyCodeLine{00354\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{svd\_precondition\_2x2\_block\_to\_be\_real}}<MatrixType,\ QRPreconditioner,\ false>}
\DoxyCodeLine{00355\ \{}
\DoxyCodeLine{00356\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ QRPreconditioner>}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{SVD}};}
\DoxyCodeLine{00357\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::RealScalar\ RealScalar;}
\DoxyCodeLine{00358\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ run(\textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{SVD::WorkMatrixType}}\&,\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{SVD}}\&,\ Index,\ Index,\ RealScalar\&)\ \{\ \textcolor{keywordflow}{return}\ \textcolor{keyword}{true};\ \}}
\DoxyCodeLine{00359\ \};}
\DoxyCodeLine{00360\ }
\DoxyCodeLine{00361\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner>}
\DoxyCodeLine{00362\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{svd\_precondition\_2x2\_block\_to\_be\_real}}<MatrixType,\ QRPreconditioner,\ true>}
\DoxyCodeLine{00363\ \{}
\DoxyCodeLine{00364\ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<MatrixType,\ QRPreconditioner>}}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{SVD}};}
\DoxyCodeLine{00365\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ Scalar;}
\DoxyCodeLine{00366\ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::RealScalar\ RealScalar;}
\DoxyCodeLine{00367\ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ run(\textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{SVD::WorkMatrixType}}\&\ work\_matrix,\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{SVD}}\&\ svd,\ Index\ p,\ Index\ q,\ RealScalar\&\ maxDiagEntry)}
\DoxyCodeLine{00368\ \ \ \{}
\DoxyCodeLine{00369\ \ \ \ \ \textcolor{keyword}{using\ }std::sqrt;}
\DoxyCodeLine{00370\ \ \ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00371\ \ \ \ \ Scalar\ z;}
\DoxyCodeLine{00372\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_rotation}{JacobiRotation<Scalar>}}\ rot;}
\DoxyCodeLine{00373\ \ \ \ \ RealScalar\ n\ =\ sqrt(numext::abs2(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(p,p))\ +\ numext::abs2(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(q,p)));}
\DoxyCodeLine{00374\ }
\DoxyCodeLine{00375\ \ \ \ \ \textcolor{keyword}{const}\ RealScalar\ considerAsZero\ =\ (std::numeric\_limits<RealScalar>::min)();}
\DoxyCodeLine{00376\ \ \ \ \ \textcolor{keyword}{const}\ RealScalar\ precision\ =\ \mbox{\hyperlink{struct_eigen_1_1_num_traits}{NumTraits<Scalar>::epsilon}}();}
\DoxyCodeLine{00377\ }
\DoxyCodeLine{00378\ \ \ \ \ \textcolor{keywordflow}{if}(n==0)}
\DoxyCodeLine{00379\ \ \ \ \ \{}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \textcolor{comment}{//\ make\ sure\ first\ column\ is\ zero}}
\DoxyCodeLine{00381\ \ \ \ \ \ \ work\_matrix.\mbox{\hyperlink{class_eigen_1_1_matrix_ad6ab241435124b11a3921df752d28daf}{coeffRef}}(p,p)\ =\ work\_matrix.\mbox{\hyperlink{class_eigen_1_1_matrix_ad6ab241435124b11a3921df752d28daf}{coeffRef}}(q,p)\ =\ Scalar(0);}
\DoxyCodeLine{00382\ }
\DoxyCodeLine{00383\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(abs(numext::imag(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(p,q)))>considerAsZero)}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ work\_matrix.coeff(p,q)\ can\ be\ zero\ if\ work\_matrix.coeff(q,p)\ is\ not\ zero\ but\ small\ enough\ to\ underflow\ when\ computing\ n}}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ z\ =\ abs(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(p,q))\ /\ work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(p,q);}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ work\_matrix.row(p)\ *=\ z;}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a705a7c2709e1624ccc19aa748a78d473}{computeU}}())\ svd.m\_matrixU.col(p)\ *=\ conj(z);}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(abs(numext::imag(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(q,q)))>considerAsZero)}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00392\ \ \ \ \ \ \ \ \ z\ =\ abs(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(q,q))\ /\ work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(q,q);}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ work\_matrix.row(q)\ *=\ z;}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a705a7c2709e1624ccc19aa748a78d473}{computeU}}())\ svd.m\_matrixU.col(q)\ *=\ conj(z);}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \textcolor{comment}{//\ otherwise\ the\ second\ row\ is\ already\ zero,\ so\ we\ have\ nothing\ to\ do.}}
\DoxyCodeLine{00397\ \ \ \ \ \}}
\DoxyCodeLine{00398\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00399\ \ \ \ \ \{}
\DoxyCodeLine{00400\ \ \ \ \ \ \ rot.c()\ =\ conj(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(p,p))\ /\ n;}
\DoxyCodeLine{00401\ \ \ \ \ \ \ rot.s()\ =\ work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(q,p)\ /\ n;}
\DoxyCodeLine{00402\ \ \ \ \ \ \ work\_matrix.applyOnTheLeft(p,q,rot);}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a705a7c2709e1624ccc19aa748a78d473}{computeU}}())\ svd.m\_matrixU.applyOnTheRight(p,q,rot.\mbox{\hyperlink{class_eigen_1_1_jacobi_rotation_a89c8ea615f8fa77ddd5810a1e5fde4da}{adjoint}}());}
\DoxyCodeLine{00404\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(abs(numext::imag(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(p,q)))>considerAsZero)}
\DoxyCodeLine{00405\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00406\ \ \ \ \ \ \ \ \ z\ =\ abs(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(p,q))\ /\ work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(p,q);}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \ \ work\_matrix.col(q)\ *=\ z;}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5f12efcb791eb007d4a4890ac5255ac4}{computeV}}())\ svd.m\_matrixV.col(q)\ *=\ z;}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(abs(numext::imag(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(q,q)))>considerAsZero)}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ z\ =\ abs(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(q,q))\ /\ work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(q,q);}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ work\_matrix.row(q)\ *=\ z;}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(svd.\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a705a7c2709e1624ccc19aa748a78d473}{computeU}}())\ svd.m\_matrixU.col(q)\ *=\ conj(z);}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00416\ \ \ \ \ \}}
\DoxyCodeLine{00417\ }
\DoxyCodeLine{00418\ \ \ \ \ \textcolor{comment}{//\ update\ largest\ diagonal\ entry}}
\DoxyCodeLine{00419\ \ \ \ \ maxDiagEntry\ =\ numext::maxi<RealScalar>(maxDiagEntry,numext::maxi<RealScalar>(abs(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(p,p)),\ abs(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(q,q))));}
\DoxyCodeLine{00420\ \ \ \ \ \textcolor{comment}{//\ and\ check\ whether\ the\ 2x2\ block\ is\ already\ diagonal}}
\DoxyCodeLine{00421\ \ \ \ \ RealScalar\ threshold\ =\ numext::maxi<RealScalar>(considerAsZero,\ precision\ *\ maxDiagEntry);}
\DoxyCodeLine{00422\ \ \ \ \ \textcolor{keywordflow}{return}\ abs(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(p,q))>threshold\ ||\ abs(work\_matrix.\mbox{\hyperlink{class_eigen_1_1_plain_object_base_aa5a84a35bf7dc5c42abf4a3e9fde222c}{coeff}}(q,p))\ >\ threshold;}
\DoxyCodeLine{00423\ \ \ \}}
\DoxyCodeLine{00424\ \};}
\DoxyCodeLine{00425\ }
\DoxyCodeLine{00426\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner>\ }
\DoxyCodeLine{00427\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1traits}{traits}}<\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD}}<\_MatrixType,QRPreconditioner>\ >}
\DoxyCodeLine{00428\ \{}
\DoxyCodeLine{00429\ \ \ \textcolor{keyword}{typedef}\ \_MatrixType\ MatrixType;}
\DoxyCodeLine{00430\ \};}
\DoxyCodeLine{00431\ }
\DoxyCodeLine{00432\ \}\ \textcolor{comment}{//\ end\ namespace\ internal}}
\DoxyCodeLine{00433\ }
\DoxyCodeLine{00487\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner>\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD}}}
\DoxyCodeLine{00488\ \ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base}{SVDBase}}<JacobiSVD<\_MatrixType,QRPreconditioner>\ >}
\DoxyCodeLine{00489\ \{}
\DoxyCodeLine{00490\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base}{SVDBase<JacobiSVD>}}\ \mbox{\hyperlink{class_eigen_1_1_s_v_d_base}{Base}};}
\DoxyCodeLine{00491\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ \ \ \ \ \textcolor{keyword}{typedef}\ \_MatrixType\ MatrixType;}
\DoxyCodeLine{00494\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ Scalar;}
\DoxyCodeLine{00495\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ NumTraits<typename\ MatrixType::Scalar>::Real\ RealScalar;}
\DoxyCodeLine{00496\ \ \ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00497\ \ \ \ \ \ \ RowsAtCompileTime\ =\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00498\ \ \ \ \ \ \ ColsAtCompileTime\ =\ MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{00499\ \ \ \ \ \ \ DiagSizeAtCompileTime\ =\ EIGEN\_SIZE\_MIN\_PREFER\_DYNAMIC(RowsAtCompileTime,ColsAtCompileTime),}
\DoxyCodeLine{00500\ \ \ \ \ \ \ MaxRowsAtCompileTime\ =\ MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{00501\ \ \ \ \ \ \ MaxColsAtCompileTime\ =\ MatrixType::MaxColsAtCompileTime,}
\DoxyCodeLine{00502\ \ \ \ \ \ \ MaxDiagSizeAtCompileTime\ =\ EIGEN\_SIZE\_MIN\_PREFER\_FIXED(MaxRowsAtCompileTime,MaxColsAtCompileTime),}
\DoxyCodeLine{00503\ \ \ \ \ \ \ MatrixOptions\ =\ MatrixType::Options}
\DoxyCodeLine{00504\ \ \ \ \ \};}
\DoxyCodeLine{00505\ }
\DoxyCodeLine{00506\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Base::MatrixUType}}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{MatrixUType}};}
\DoxyCodeLine{00507\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Base::MatrixVType}}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{MatrixVType}};}
\DoxyCodeLine{00508\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1true__type}{Base::SingularValuesType}}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1true__type}{SingularValuesType}};}
\DoxyCodeLine{00509\ \ \ \ \ }
\DoxyCodeLine{00510\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1true__type}{internal::plain\_row\_type<MatrixType>::type}}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1true__type}{RowType}};}
\DoxyCodeLine{00511\ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1true__type}{internal::plain\_col\_type<MatrixType>::type}}\ \mbox{\hyperlink{struct_eigen_1_1internal_1_1true__type}{ColType}};}
\DoxyCodeLine{00512\ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix}}<Scalar,\ DiagSizeAtCompileTime,\ DiagSizeAtCompileTime,}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ MatrixOptions,\ MaxDiagSizeAtCompileTime,\ MaxDiagSizeAtCompileTime>}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_matrix}{WorkMatrixType}};}
\DoxyCodeLine{00515\ }
\DoxyCodeLine{00521\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a55315ab9cd060019a5ad07be798ff3b9}{JacobiSVD}}()}
\DoxyCodeLine{00522\ \ \ \ \ \{\}}
\DoxyCodeLine{00523\ }
\DoxyCodeLine{00524\ }
\DoxyCodeLine{00531\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5d9ea7c8f361337727260efd77ee03ac}{JacobiSVD}}(Index\ rows,\ Index\ cols,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions\ =\ 0)}
\DoxyCodeLine{00532\ \ \ \ \ \{}
\DoxyCodeLine{00533\ \ \ \ \ \ \ allocate(rows,\ cols,\ computationOptions);}
\DoxyCodeLine{00534\ \ \ \ \ \}}
\DoxyCodeLine{00535\ }
\DoxyCodeLine{00546\ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_abfd1dd454a6e3edec7feecd97c818a78}{JacobiSVD}}(\textcolor{keyword}{const}\ MatrixType\&\ matrix,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions\ =\ 0)}
\DoxyCodeLine{00547\ \ \ \ \ \{}
\DoxyCodeLine{00548\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5dab376cc86cf0d36674bcdad4af3f5a}{compute}}(matrix,\ computationOptions);}
\DoxyCodeLine{00549\ \ \ \ \ \}}
\DoxyCodeLine{00550\ }
\DoxyCodeLine{00561\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD}}\&\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5dab376cc86cf0d36674bcdad4af3f5a}{compute}}(\textcolor{keyword}{const}\ MatrixType\&\ matrix,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions);}
\DoxyCodeLine{00562\ }
\DoxyCodeLine{00569\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD}}\&\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a408ef2580962859ff292eca69aa4b976}{compute}}(\textcolor{keyword}{const}\ MatrixType\&\ matrix)}
\DoxyCodeLine{00570\ \ \ \ \ \{}
\DoxyCodeLine{00571\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5dab376cc86cf0d36674bcdad4af3f5a}{compute}}(matrix,\ m\_computationOptions);}
\DoxyCodeLine{00572\ \ \ \ \ \}}
\DoxyCodeLine{00573\ }
\DoxyCodeLine{00574\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a705a7c2709e1624ccc19aa748a78d473}{Base::computeU}};}
\DoxyCodeLine{00575\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a5f12efcb791eb007d4a4890ac5255ac4}{Base::computeV}};}
\DoxyCodeLine{00576\ \ \ \ \ \textcolor{keyword}{using\ }Base::rows;}
\DoxyCodeLine{00577\ \ \ \ \ \textcolor{keyword}{using\ }Base::cols;}
\DoxyCodeLine{00578\ \ \ \ \ \textcolor{keyword}{using\ }\mbox{\hyperlink{class_eigen_1_1_s_v_d_base_a30b89e24f42f1692079eea31b361d26a}{Base::rank}};}
\DoxyCodeLine{00579\ }
\DoxyCodeLine{00580\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00581\ \ \ \ \ \textcolor{keywordtype}{void}\ allocate(Index\ rows,\ Index\ cols,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions);}
\DoxyCodeLine{00582\ }
\DoxyCodeLine{00583\ \ \ \textcolor{keyword}{protected}:}
\DoxyCodeLine{00584\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_matrixU;}
\DoxyCodeLine{00585\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_matrixV;}
\DoxyCodeLine{00586\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_singularValues;}
\DoxyCodeLine{00587\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_isInitialized;}
\DoxyCodeLine{00588\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_isAllocated;}
\DoxyCodeLine{00589\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_usePrescribedThreshold;}
\DoxyCodeLine{00590\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_computeFullU;}
\DoxyCodeLine{00591\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_computeThinU;}
\DoxyCodeLine{00592\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_computeFullV;}
\DoxyCodeLine{00593\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_computeThinV;}
\DoxyCodeLine{00594\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_computationOptions;}
\DoxyCodeLine{00595\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_nonzeroSingularValues;}
\DoxyCodeLine{00596\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_rows;}
\DoxyCodeLine{00597\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_cols;}
\DoxyCodeLine{00598\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_diagSize;}
\DoxyCodeLine{00599\ \ \ \ \ \textcolor{keyword}{using\ }Base::m\_prescribedThreshold;}
\DoxyCodeLine{00600\ \ \ \ \ WorkMatrixType\ m\_workMatrix;}
\DoxyCodeLine{00601\ }
\DoxyCodeLine{00602\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_\_MatrixType,\ \textcolor{keywordtype}{int}\ \_QRPreconditioner,\ \textcolor{keywordtype}{bool}\ \_IsComplex>}
\DoxyCodeLine{00603\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{internal::svd\_precondition\_2x2\_block\_to\_be\_real}};}
\DoxyCodeLine{00604\ \ \ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_\_MatrixType,\ \textcolor{keywordtype}{int}\ \_QRPreconditioner,\ \textcolor{keywordtype}{int}\ \_Case,\ \textcolor{keywordtype}{bool}\ \_DoAnything>}
\DoxyCodeLine{00605\ \ \ \ \ \textcolor{keyword}{friend}\ \textcolor{keyword}{struct\ }\mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{internal::qr\_preconditioner\_impl}};}
\DoxyCodeLine{00606\ }
\DoxyCodeLine{00607\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{internal::qr\_preconditioner\_impl<MatrixType,\ QRPreconditioner,\ internal::PreconditionIfMoreColsThanRows>}}\ m\_qr\_precond\_morecols;}
\DoxyCodeLine{00608\ \ \ \ \ \mbox{\hyperlink{struct_eigen_1_1internal_1_1qr__preconditioner__impl}{internal::qr\_preconditioner\_impl<MatrixType,\ QRPreconditioner,\ internal::PreconditionIfMoreRowsThanCols>}}\ m\_qr\_precond\_morerows;}
\DoxyCodeLine{00609\ \ \ \ \ MatrixType\ m\_scaledMatrix;}
\DoxyCodeLine{00610\ \};}
\DoxyCodeLine{00611\ }
\DoxyCodeLine{00612\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner>}
\DoxyCodeLine{00613\ \textcolor{keywordtype}{void}\ JacobiSVD<MatrixType,\ QRPreconditioner>::allocate(Index\ rows,\ Index\ cols,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions)}
\DoxyCodeLine{00614\ \{}
\DoxyCodeLine{00615\ \ \ eigen\_assert(rows\ >=\ 0\ \&\&\ cols\ >=\ 0);}
\DoxyCodeLine{00616\ }
\DoxyCodeLine{00617\ \ \ \textcolor{keywordflow}{if}\ (m\_isAllocated\ \&\&}
\DoxyCodeLine{00618\ \ \ \ \ \ \ rows\ ==\ m\_rows\ \&\&}
\DoxyCodeLine{00619\ \ \ \ \ \ \ cols\ ==\ m\_cols\ \&\&}
\DoxyCodeLine{00620\ \ \ \ \ \ \ computationOptions\ ==\ m\_computationOptions)}
\DoxyCodeLine{00621\ \ \ \{}
\DoxyCodeLine{00622\ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00623\ \ \ \}}
\DoxyCodeLine{00624\ }
\DoxyCodeLine{00625\ \ \ m\_rows\ =\ rows;}
\DoxyCodeLine{00626\ \ \ m\_cols\ =\ cols;}
\DoxyCodeLine{00627\ \ \ m\_isInitialized\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00628\ \ \ m\_isAllocated\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00629\ \ \ m\_computationOptions\ =\ computationOptions;}
\DoxyCodeLine{00630\ \ \ m\_computeFullU\ =\ (computationOptions\ \&\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a9fa9302d510cee20c26311154937e23f}{ComputeFullU}})\ !=\ 0;}
\DoxyCodeLine{00631\ \ \ m\_computeThinU\ =\ (computationOptions\ \&\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9aa7fb4e98834788d0b1b0f2b8467d2527}{ComputeThinU}})\ !=\ 0;}
\DoxyCodeLine{00632\ \ \ m\_computeFullV\ =\ (computationOptions\ \&\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a36581f7c662f7def31efd500c284f930}{ComputeFullV}})\ !=\ 0;}
\DoxyCodeLine{00633\ \ \ m\_computeThinV\ =\ (computationOptions\ \&\ \mbox{\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a540036417bfecf2e791a70948c227f47}{ComputeThinV}})\ !=\ 0;}
\DoxyCodeLine{00634\ \ \ eigen\_assert(!(m\_computeFullU\ \&\&\ m\_computeThinU)\ \&\&\ \textcolor{stringliteral}{"{}JacobiSVD:\ you\ can't\ ask\ for\ both\ full\ and\ thin\ U"{}});}
\DoxyCodeLine{00635\ \ \ eigen\_assert(!(m\_computeFullV\ \&\&\ m\_computeThinV)\ \&\&\ \textcolor{stringliteral}{"{}JacobiSVD:\ you\ can't\ ask\ for\ both\ full\ and\ thin\ V"{}});}
\DoxyCodeLine{00636\ \ \ eigen\_assert(EIGEN\_IMPLIES(m\_computeThinU\ ||\ m\_computeThinV,\ MatrixType::ColsAtCompileTime==Dynamic)\ \&\&}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}JacobiSVD:\ thin\ U\ and\ V\ are\ only\ available\ when\ your\ matrix\ has\ a\ dynamic\ number\ of\ columns."{}});}
\DoxyCodeLine{00638\ \ \ \textcolor{keywordflow}{if}\ (QRPreconditioner\ ==\ \mbox{\hyperlink{group__enums_gga46eba0d5c621f590b8cf1b53af31d56eabd745dcaff7019c5f918c68809e5ea50}{FullPivHouseholderQRPreconditioner}})}
\DoxyCodeLine{00639\ \ \ \{}
\DoxyCodeLine{00640\ \ \ \ \ \ \ eigen\_assert(!(m\_computeThinU\ ||\ m\_computeThinV)\ \&\&}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}JacobiSVD:\ can't\ compute\ thin\ U\ or\ thin\ V\ with\ the\ FullPivHouseholderQR\ preconditioner.\ "{}}}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{stringliteral}{"{}Use\ the\ ColPivHouseholderQR\ preconditioner\ instead."{}});}
\DoxyCodeLine{00643\ \ \ \}}
\DoxyCodeLine{00644\ \ \ m\_diagSize\ =\ (std::min)(m\_rows,\ m\_cols);}
\DoxyCodeLine{00645\ \ \ m\_singularValues.resize(m\_diagSize);}
\DoxyCodeLine{00646\ \ \ \textcolor{keywordflow}{if}(RowsAtCompileTime==Dynamic)}
\DoxyCodeLine{00647\ \ \ \ \ m\_matrixU.resize(m\_rows,\ m\_computeFullU\ ?\ m\_rows}
\DoxyCodeLine{00648\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ m\_computeThinU\ ?\ m\_diagSize}
\DoxyCodeLine{00649\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ 0);}
\DoxyCodeLine{00650\ \ \ \textcolor{keywordflow}{if}(ColsAtCompileTime==Dynamic)}
\DoxyCodeLine{00651\ \ \ \ \ m\_matrixV.resize(m\_cols,\ m\_computeFullV\ ?\ m\_cols}
\DoxyCodeLine{00652\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ m\_computeThinV\ ?\ m\_diagSize}
\DoxyCodeLine{00653\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ :\ 0);}
\DoxyCodeLine{00654\ \ \ m\_workMatrix.resize(m\_diagSize,\ m\_diagSize);}
\DoxyCodeLine{00655\ \ \ }
\DoxyCodeLine{00656\ \ \ \textcolor{keywordflow}{if}(m\_cols>m\_rows)\ \ \ m\_qr\_precond\_morecols.allocate(*\textcolor{keyword}{this});}
\DoxyCodeLine{00657\ \ \ \textcolor{keywordflow}{if}(m\_rows>m\_cols)\ \ \ m\_qr\_precond\_morerows.allocate(*\textcolor{keyword}{this});}
\DoxyCodeLine{00658\ \ \ \textcolor{keywordflow}{if}(m\_rows!=m\_cols)\ \ m\_scaledMatrix.resize(rows,cols);}
\DoxyCodeLine{00659\ \}}
\DoxyCodeLine{00660\ }
\DoxyCodeLine{00661\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType,\ \textcolor{keywordtype}{int}\ QRPreconditioner>}
\DoxyCodeLine{00662\ JacobiSVD<MatrixType,\ QRPreconditioner>\&}
\DoxyCodeLine{00663\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d_a5dab376cc86cf0d36674bcdad4af3f5a}{JacobiSVD<MatrixType,\ QRPreconditioner>::compute}}(\textcolor{keyword}{const}\ MatrixType\&\ matrix,\ \textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions)}
\DoxyCodeLine{00664\ \{}
\DoxyCodeLine{00665\ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00666\ \ \ allocate(matrix.rows(),\ matrix.cols(),\ computationOptions);}
\DoxyCodeLine{00667\ }
\DoxyCodeLine{00668\ \ \ \textcolor{comment}{//\ currently\ we\ stop\ when\ we\ reach\ precision\ 2*epsilon\ as\ the\ last\ bit\ of\ precision\ can\ require\ an\ unreasonable\ number\ of\ iterations,}}
\DoxyCodeLine{00669\ \ \ \textcolor{comment}{//\ only\ worsening\ the\ precision\ of\ U\ and\ V\ as\ we\ accumulate\ more\ rotations}}
\DoxyCodeLine{00670\ \ \ \textcolor{keyword}{const}\ RealScalar\ precision\ =\ RealScalar(2)\ *\ \mbox{\hyperlink{struct_eigen_1_1_num_traits}{NumTraits<Scalar>::epsilon}}();}
\DoxyCodeLine{00671\ }
\DoxyCodeLine{00672\ \ \ \textcolor{comment}{//\ limit\ for\ denormal\ numbers\ to\ be\ considered\ zero\ in\ order\ to\ avoid\ infinite\ loops\ (see\ bug\ 286)}}
\DoxyCodeLine{00673\ \ \ \textcolor{keyword}{const}\ RealScalar\ considerAsZero\ =\ (std::numeric\_limits<RealScalar>::min)();}
\DoxyCodeLine{00674\ }
\DoxyCodeLine{00675\ \ \ \textcolor{comment}{//\ Scaling\ factor\ to\ reduce\ over/under-\/flows}}
\DoxyCodeLine{00676\ \ \ RealScalar\ scale\ =\ matrix.cwiseAbs().maxCoeff();}
\DoxyCodeLine{00677\ \ \ \textcolor{keywordflow}{if}(scale==RealScalar(0))\ scale\ =\ RealScalar(1);}
\DoxyCodeLine{00678\ \ \ }
\DoxyCodeLine{00679\ \textcolor{comment}{\ \ /***\ step\ 1.\ The\ R-\/SVD\ step:\ we\ use\ a\ QR\ decomposition\ to\ reduce\ to\ the\ case\ of\ a\ square\ matrix\ */}}
\DoxyCodeLine{00680\ }
\DoxyCodeLine{00681\ \ \ \textcolor{keywordflow}{if}(m\_rows!=m\_cols)}
\DoxyCodeLine{00682\ \ \ \{}
\DoxyCodeLine{00683\ \ \ \ \ m\_scaledMatrix\ =\ matrix\ /\ scale;}
\DoxyCodeLine{00684\ \ \ \ \ m\_qr\_precond\_morecols.run(*\textcolor{keyword}{this},\ m\_scaledMatrix);}
\DoxyCodeLine{00685\ \ \ \ \ m\_qr\_precond\_morerows.run(*\textcolor{keyword}{this},\ m\_scaledMatrix);}
\DoxyCodeLine{00686\ \ \ \}}
\DoxyCodeLine{00687\ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00688\ \ \ \{}
\DoxyCodeLine{00689\ \ \ \ \ m\_workMatrix\ =\ matrix.block(0,0,m\_diagSize,m\_diagSize)\ /\ scale;}
\DoxyCodeLine{00690\ \ \ \ \ \textcolor{keywordflow}{if}(m\_computeFullU)\ m\_matrixU.setIdentity(m\_rows,m\_rows);}
\DoxyCodeLine{00691\ \ \ \ \ \textcolor{keywordflow}{if}(m\_computeThinU)\ m\_matrixU.setIdentity(m\_rows,m\_diagSize);}
\DoxyCodeLine{00692\ \ \ \ \ \textcolor{keywordflow}{if}(m\_computeFullV)\ m\_matrixV.setIdentity(m\_cols,m\_cols);}
\DoxyCodeLine{00693\ \ \ \ \ \textcolor{keywordflow}{if}(m\_computeThinV)\ m\_matrixV.setIdentity(m\_cols,\ m\_diagSize);}
\DoxyCodeLine{00694\ \ \ \}}
\DoxyCodeLine{00695\ }
\DoxyCodeLine{00696\ \textcolor{comment}{\ \ /***\ step\ 2.\ The\ main\ Jacobi\ SVD\ iteration.\ ***/}}
\DoxyCodeLine{00697\ \ \ RealScalar\ maxDiagEntry\ =\ m\_workMatrix.cwiseAbs().diagonal().maxCoeff();}
\DoxyCodeLine{00698\ }
\DoxyCodeLine{00699\ \ \ \textcolor{keywordtype}{bool}\ finished\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00700\ \ \ \textcolor{keywordflow}{while}(!finished)}
\DoxyCodeLine{00701\ \ \ \{}
\DoxyCodeLine{00702\ \ \ \ \ finished\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00703\ }
\DoxyCodeLine{00704\ \ \ \ \ \textcolor{comment}{//\ do\ a\ sweep:\ for\ all\ index\ pairs\ (p,q),\ perform\ SVD\ of\ the\ corresponding\ 2x2\ sub-\/matrix}}
\DoxyCodeLine{00705\ }
\DoxyCodeLine{00706\ \ \ \ \ \textcolor{keywordflow}{for}(Index\ p\ =\ 1;\ p\ <\ m\_diagSize;\ ++p)}
\DoxyCodeLine{00707\ \ \ \ \ \{}
\DoxyCodeLine{00708\ \ \ \ \ \ \ \textcolor{keywordflow}{for}(Index\ q\ =\ 0;\ q\ <\ p;\ ++q)}
\DoxyCodeLine{00709\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00710\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ this\ 2x2\ sub-\/matrix\ is\ not\ diagonal\ already...}}
\DoxyCodeLine{00711\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ notice\ that\ this\ comparison\ will\ evaluate\ to\ false\ if\ any\ NaN\ is\ involved,\ ensuring\ that\ NaN's\ don't}}
\DoxyCodeLine{00712\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ keep\ us\ iterating\ forever.\ Similarly,\ small\ denormal\ numbers\ are\ considered\ zero.}}
\DoxyCodeLine{00713\ \ \ \ \ \ \ \ \ RealScalar\ threshold\ =\ numext::maxi<RealScalar>(considerAsZero,\ precision\ *\ maxDiagEntry);}
\DoxyCodeLine{00714\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(abs(m\_workMatrix.coeff(p,q))>threshold\ ||\ abs(m\_workMatrix.coeff(q,p))\ >\ threshold)}
\DoxyCodeLine{00715\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00716\ \ \ \ \ \ \ \ \ \ \ finished\ =\ \textcolor{keyword}{false};}
\DoxyCodeLine{00717\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ perform\ SVD\ decomposition\ of\ 2x2\ sub-\/matrix\ corresponding\ to\ indices\ p,q\ to\ make\ it\ diagonal}}
\DoxyCodeLine{00718\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ the\ complex\ to\ real\ operation\ returns\ true\ if\ the\ updated\ 2x2\ block\ is\ not\ already\ diagonal}}
\DoxyCodeLine{00719\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{struct_eigen_1_1internal_1_1svd__precondition__2x2__block__to__be__real}{internal::svd\_precondition\_2x2\_block\_to\_be\_real<MatrixType,\ QRPreconditioner>::run}}(m\_workMatrix,\ *\textcolor{keyword}{this},\ p,\ q,\ maxDiagEntry))}
\DoxyCodeLine{00720\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00721\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_rotation}{JacobiRotation<RealScalar>}}\ j\_left,\ j\_right;}
\DoxyCodeLine{00722\ \ \ \ \ \ \ \ \ \ \ \ \ internal::real\_2x2\_jacobi\_svd(m\_workMatrix,\ p,\ q,\ \&j\_left,\ \&j\_right);}
\DoxyCodeLine{00723\ }
\DoxyCodeLine{00724\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ accumulate\ resulting\ Jacobi\ rotations}}
\DoxyCodeLine{00725\ \ \ \ \ \ \ \ \ \ \ \ \ m\_workMatrix.applyOnTheLeft(p,q,j\_left);}
\DoxyCodeLine{00726\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(computeU())\ m\_matrixU.applyOnTheRight(p,q,j\_left.\mbox{\hyperlink{class_eigen_1_1_jacobi_rotation_ab40e9cdc4582593511e57ee896e055a2}{transpose}}());}
\DoxyCodeLine{00727\ }
\DoxyCodeLine{00728\ \ \ \ \ \ \ \ \ \ \ \ \ m\_workMatrix.applyOnTheRight(p,q,j\_right);}
\DoxyCodeLine{00729\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(computeV())\ m\_matrixV.applyOnTheRight(p,q,j\_right);}
\DoxyCodeLine{00730\ }
\DoxyCodeLine{00731\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ keep\ track\ of\ the\ largest\ diagonal\ coefficient}}
\DoxyCodeLine{00732\ \ \ \ \ \ \ \ \ \ \ \ \ maxDiagEntry\ =\ numext::maxi<RealScalar>(maxDiagEntry,numext::maxi<RealScalar>(abs(m\_workMatrix.coeff(p,p)),\ abs(m\_workMatrix.coeff(q,q))));}
\DoxyCodeLine{00733\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00734\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00735\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00736\ \ \ \ \ \}}
\DoxyCodeLine{00737\ \ \ \}}
\DoxyCodeLine{00738\ }
\DoxyCodeLine{00739\ \textcolor{comment}{\ \ /***\ step\ 3.\ The\ work\ matrix\ is\ now\ diagonal,\ so\ ensure\ it's\ positive\ so\ its\ diagonal\ entries\ are\ the\ singular\ values\ ***/}}
\DoxyCodeLine{00740\ }
\DoxyCodeLine{00741\ \ \ \textcolor{keywordflow}{for}(Index\ i\ =\ 0;\ i\ <\ m\_diagSize;\ ++i)}
\DoxyCodeLine{00742\ \ \ \{}
\DoxyCodeLine{00743\ \ \ \ \ \textcolor{comment}{//\ For\ a\ complex\ matrix,\ some\ diagonal\ coefficients\ might\ note\ have\ been}}
\DoxyCodeLine{00744\ \ \ \ \ \textcolor{comment}{//\ treated\ by\ svd\_precondition\_2x2\_block\_to\_be\_real,\ and\ the\ imaginary\ part}}
\DoxyCodeLine{00745\ \ \ \ \ \textcolor{comment}{//\ of\ some\ diagonal\ entry\ might\ not\ be\ null.}}
\DoxyCodeLine{00746\ \ \ \ \ \textcolor{keywordflow}{if}(\mbox{\hyperlink{struct_eigen_1_1_num_traits}{NumTraits<Scalar>::IsComplex}}\ \&\&\ abs(numext::imag(m\_workMatrix.coeff(i,i)))>considerAsZero)}
\DoxyCodeLine{00747\ \ \ \ \ \{}
\DoxyCodeLine{00748\ \ \ \ \ \ \ RealScalar\ a\ =\ abs(m\_workMatrix.coeff(i,i));}
\DoxyCodeLine{00749\ \ \ \ \ \ \ m\_singularValues.coeffRef(i)\ =\ abs(a);}
\DoxyCodeLine{00750\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(computeU())\ m\_matrixU.col(i)\ *=\ m\_workMatrix.coeff(i,i)/a;}
\DoxyCodeLine{00751\ \ \ \ \ \}}
\DoxyCodeLine{00752\ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00753\ \ \ \ \ \{}
\DoxyCodeLine{00754\ \ \ \ \ \ \ \textcolor{comment}{//\ m\_workMatrix.coeff(i,i)\ is\ already\ real,\ no\ difficulty:}}
\DoxyCodeLine{00755\ \ \ \ \ \ \ RealScalar\ a\ =\ numext::real(m\_workMatrix.coeff(i,i));}
\DoxyCodeLine{00756\ \ \ \ \ \ \ m\_singularValues.coeffRef(i)\ =\ abs(a);}
\DoxyCodeLine{00757\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(computeU()\ \&\&\ (a<RealScalar(0)))\ m\_matrixU.col(i)\ =\ -\/m\_matrixU.col(i);}
\DoxyCodeLine{00758\ \ \ \ \ \}}
\DoxyCodeLine{00759\ \ \ \}}
\DoxyCodeLine{00760\ \ \ }
\DoxyCodeLine{00761\ \ \ m\_singularValues\ *=\ scale;}
\DoxyCodeLine{00762\ }
\DoxyCodeLine{00763\ \textcolor{comment}{\ \ /***\ step\ 4.\ Sort\ singular\ values\ in\ descending\ order\ and\ compute\ the\ number\ of\ nonzero\ singular\ values\ ***/}}
\DoxyCodeLine{00764\ }
\DoxyCodeLine{00765\ \ \ m\_nonzeroSingularValues\ =\ m\_diagSize;}
\DoxyCodeLine{00766\ \ \ \textcolor{keywordflow}{for}(Index\ i\ =\ 0;\ i\ <\ m\_diagSize;\ i++)}
\DoxyCodeLine{00767\ \ \ \{}
\DoxyCodeLine{00768\ \ \ \ \ Index\ pos;}
\DoxyCodeLine{00769\ \ \ \ \ RealScalar\ maxRemainingSingularValue\ =\ m\_singularValues.tail(m\_diagSize-\/i).maxCoeff(\&pos);}
\DoxyCodeLine{00770\ \ \ \ \ \textcolor{keywordflow}{if}(maxRemainingSingularValue\ ==\ RealScalar(0))}
\DoxyCodeLine{00771\ \ \ \ \ \{}
\DoxyCodeLine{00772\ \ \ \ \ \ \ m\_nonzeroSingularValues\ =\ i;}
\DoxyCodeLine{00773\ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00774\ \ \ \ \ \}}
\DoxyCodeLine{00775\ \ \ \ \ \textcolor{keywordflow}{if}(pos)}
\DoxyCodeLine{00776\ \ \ \ \ \{}
\DoxyCodeLine{00777\ \ \ \ \ \ \ pos\ +=\ i;}
\DoxyCodeLine{00778\ \ \ \ \ \ \ std::swap(m\_singularValues.coeffRef(i),\ m\_singularValues.coeffRef(pos));}
\DoxyCodeLine{00779\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(computeU())\ m\_matrixU.col(pos).swap(m\_matrixU.col(i));}
\DoxyCodeLine{00780\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(computeV())\ m\_matrixV.col(pos).swap(m\_matrixV.col(i));}
\DoxyCodeLine{00781\ \ \ \ \ \}}
\DoxyCodeLine{00782\ \ \ \}}
\DoxyCodeLine{00783\ }
\DoxyCodeLine{00784\ \ \ m\_isInitialized\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00785\ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00786\ \}}
\DoxyCodeLine{00787\ }
\DoxyCodeLine{00795\ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ Derived>}
\DoxyCodeLine{00796\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<typename\ MatrixBase<Derived>::PlainObject}}>}
\DoxyCodeLine{00797\ \mbox{\hyperlink{class_eigen_1_1_matrix_base_a5745dca9c54390633b434e54a1d1eedd}{MatrixBase<Derived>::jacobiSvd}}(\textcolor{keywordtype}{unsigned}\ \textcolor{keywordtype}{int}\ computationOptions)\textcolor{keyword}{\ const}}
\DoxyCodeLine{00798\ \textcolor{keyword}{}\{}
\DoxyCodeLine{00799\ \ \ \textcolor{keywordflow}{return}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_s_v_d}{JacobiSVD<PlainObject>}}(*\textcolor{keyword}{this},\ computationOptions);}
\DoxyCodeLine{00800\ \}}
\DoxyCodeLine{00801\ }
\DoxyCodeLine{00802\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{00803\ }
\DoxyCodeLine{00804\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//\ EIGEN\_JACOBISVD\_H}}

\end{DoxyCode}
