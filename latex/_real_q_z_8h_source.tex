\doxysection{Real\+QZ.\+h}
\hypertarget{_real_q_z_8h_source}{}\label{_real_q_z_8h_source}\index{packages/Eigen.3.3.3/build/native/include/Eigen/src/Eigenvalues/RealQZ.h@{packages/Eigen.3.3.3/build/native/include/Eigen/src/Eigenvalues/RealQZ.h}}

\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{comment}{//\ This\ file\ is\ part\ of\ Eigen,\ a\ lightweight\ C++\ template\ library}}
\DoxyCodeLine{00002\ \textcolor{comment}{//\ for\ linear\ algebra.}}
\DoxyCodeLine{00003\ \textcolor{comment}{//}}
\DoxyCodeLine{00004\ \textcolor{comment}{//\ Copyright\ (C)\ 2012\ Alexey\ Korepanov\ <kaikaikai@yandex.ru>}}
\DoxyCodeLine{00005\ \textcolor{comment}{//}}
\DoxyCodeLine{00006\ \textcolor{comment}{//\ This\ Source\ Code\ Form\ is\ subject\ to\ the\ terms\ of\ the\ Mozilla}}
\DoxyCodeLine{00007\ \textcolor{comment}{//\ Public\ License\ v.\ 2.0.\ If\ a\ copy\ of\ the\ MPL\ was\ not\ distributed}}
\DoxyCodeLine{00008\ \textcolor{comment}{//\ with\ this\ file,\ You\ can\ obtain\ one\ at\ http://mozilla.org/MPL/2.0/.}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#ifndef\ EIGEN\_REAL\_QZ\_H}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#define\ EIGEN\_REAL\_QZ\_H}}
\DoxyCodeLine{00012\ }
\DoxyCodeLine{00013\ \textcolor{keyword}{namespace\ }Eigen\ \{}
\DoxyCodeLine{00014\ }
\DoxyCodeLine{00057\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ \_MatrixType>\ \textcolor{keyword}{class\ }\mbox{\hyperlink{class_eigen_1_1_real_q_z}{RealQZ}}}
\DoxyCodeLine{00058\ \ \ \{}
\DoxyCodeLine{00059\ \ \ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00060\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \_MatrixType\ MatrixType;}
\DoxyCodeLine{00061\ \ \ \ \ \ \ \textcolor{keyword}{enum}\ \{}
\DoxyCodeLine{00062\ \ \ \ \ \ \ \ \ RowsAtCompileTime\ =\ MatrixType::RowsAtCompileTime,}
\DoxyCodeLine{00063\ \ \ \ \ \ \ \ \ ColsAtCompileTime\ =\ MatrixType::ColsAtCompileTime,}
\DoxyCodeLine{00064\ \ \ \ \ \ \ \ \ Options\ =\ MatrixType::Options,}
\DoxyCodeLine{00065\ \ \ \ \ \ \ \ \ MaxRowsAtCompileTime\ =\ MatrixType::MaxRowsAtCompileTime,}
\DoxyCodeLine{00066\ \ \ \ \ \ \ \ \ MaxColsAtCompileTime\ =\ MatrixType::MaxColsAtCompileTime}
\DoxyCodeLine{00067\ \ \ \ \ \ \ \};}
\DoxyCodeLine{00068\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \textcolor{keyword}{typename}\ MatrixType::Scalar\ Scalar;}
\DoxyCodeLine{00069\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ std::complex<typename\ NumTraits<Scalar>::Real>\ ComplexScalar;}
\DoxyCodeLine{00070\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ Eigen::Index\ \mbox{\hyperlink{class_eigen_1_1_real_q_z_a6201e534e901b5f4e66f72c176b534a3}{Index}};\ }
\DoxyCodeLine{00071\ }
\DoxyCodeLine{00072\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<ComplexScalar,\ ColsAtCompileTime,\ 1,\ Options\ \&\ \string~RowMajor,\ MaxColsAtCompileTime,\ 1>}}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{EigenvalueType}};}
\DoxyCodeLine{00073\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,\ ColsAtCompileTime,\ 1,\ Options\ \&\ \string~RowMajor,\ MaxColsAtCompileTime,\ 1>}}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{ColumnVectorType}};}
\DoxyCodeLine{00074\ }
\DoxyCodeLine{00086\ \ \ \ \ \ \ \textcolor{keyword}{explicit}\ \mbox{\hyperlink{class_eigen_1_1_real_q_z_ad8fb9235870a8361a2fdd8dcc2e80d01}{RealQZ}}(\mbox{\hyperlink{class_eigen_1_1_real_q_z_a6201e534e901b5f4e66f72c176b534a3}{Index}}\ size\ =\ RowsAtCompileTime==Dynamic\ ?\ 1\ :\ RowsAtCompileTime)\ :}
\DoxyCodeLine{00087\ \ \ \ \ \ \ \ \ m\_S(size,\ size),}
\DoxyCodeLine{00088\ \ \ \ \ \ \ \ \ m\_T(size,\ size),}
\DoxyCodeLine{00089\ \ \ \ \ \ \ \ \ m\_Q(size,\ size),}
\DoxyCodeLine{00090\ \ \ \ \ \ \ \ \ m\_Z(size,\ size),}
\DoxyCodeLine{00091\ \ \ \ \ \ \ \ \ m\_workspace(size*2),}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \ \ m\_maxIters(400),}
\DoxyCodeLine{00093\ \ \ \ \ \ \ \ \ m\_isInitialized(false)}
\DoxyCodeLine{00094\ \ \ \ \ \ \ \ \ \{\ \}}
\DoxyCodeLine{00095\ }
\DoxyCodeLine{00104\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_real_q_z_ac6e41c839f8dae31c9a3906ea7540119}{RealQZ}}(\textcolor{keyword}{const}\ MatrixType\&\ A,\ \textcolor{keyword}{const}\ MatrixType\&\ B,\ \textcolor{keywordtype}{bool}\ computeQZ\ =\ \textcolor{keyword}{true})\ :}
\DoxyCodeLine{00105\ \ \ \ \ \ \ \ \ m\_S(A.rows(),A.cols()),}
\DoxyCodeLine{00106\ \ \ \ \ \ \ \ \ m\_T(A.rows(),A.cols()),}
\DoxyCodeLine{00107\ \ \ \ \ \ \ \ \ m\_Q(A.rows(),A.cols()),}
\DoxyCodeLine{00108\ \ \ \ \ \ \ \ \ m\_Z(A.rows(),A.cols()),}
\DoxyCodeLine{00109\ \ \ \ \ \ \ \ \ m\_workspace(A.rows()*2),}
\DoxyCodeLine{00110\ \ \ \ \ \ \ \ \ m\_maxIters(400),}
\DoxyCodeLine{00111\ \ \ \ \ \ \ \ \ m\_isInitialized(false)\ \{}
\DoxyCodeLine{00112\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_real_q_z_a2b6847964d9f1903193cc3e67c196849}{compute}}(A,\ B,\ computeQZ);}
\DoxyCodeLine{00113\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00119\ \ \ \ \ \ \ \textcolor{keyword}{const}\ MatrixType\&\ \mbox{\hyperlink{class_eigen_1_1_real_q_z_a11cf08e1665270e3fff79d3d2dab2808}{matrixQ}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00120\ \ \ \ \ \ \ \ \ eigen\_assert(m\_isInitialized\ \&\&\ \textcolor{stringliteral}{"{}RealQZ\ is\ not\ initialized."{}});}
\DoxyCodeLine{00121\ \ \ \ \ \ \ \ \ eigen\_assert(m\_computeQZ\ \&\&\ \textcolor{stringliteral}{"{}The\ matrices\ Q\ and\ Z\ have\ not\ been\ computed\ during\ the\ QZ\ decomposition."{}});}
\DoxyCodeLine{00122\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_Q;}
\DoxyCodeLine{00123\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00124\ }
\DoxyCodeLine{00129\ \ \ \ \ \ \ \textcolor{keyword}{const}\ MatrixType\&\ \mbox{\hyperlink{class_eigen_1_1_real_q_z_ae7079c9a47adad4481f725b34b128224}{matrixZ}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00130\ \ \ \ \ \ \ \ \ eigen\_assert(m\_isInitialized\ \&\&\ \textcolor{stringliteral}{"{}RealQZ\ is\ not\ initialized."{}});}
\DoxyCodeLine{00131\ \ \ \ \ \ \ \ \ eigen\_assert(m\_computeQZ\ \&\&\ \textcolor{stringliteral}{"{}The\ matrices\ Q\ and\ Z\ have\ not\ been\ computed\ during\ the\ QZ\ decomposition."{}});}
\DoxyCodeLine{00132\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_Z;}
\DoxyCodeLine{00133\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00134\ }
\DoxyCodeLine{00139\ \ \ \ \ \ \ \textcolor{keyword}{const}\ MatrixType\&\ \mbox{\hyperlink{class_eigen_1_1_real_q_z_ad9853b7d5692329aec3d3dd369c91f3c}{matrixS}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ eigen\_assert(m\_isInitialized\ \&\&\ \textcolor{stringliteral}{"{}RealQZ\ is\ not\ initialized."{}});}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_S;}
\DoxyCodeLine{00142\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00143\ }
\DoxyCodeLine{00148\ \ \ \ \ \ \ \textcolor{keyword}{const}\ MatrixType\&\ \mbox{\hyperlink{class_eigen_1_1_real_q_z_a8ee4a24f52d983c86b6b3e62f2f9c3cd}{matrixT}}()\textcolor{keyword}{\ const\ }\{}
\DoxyCodeLine{00149\ \ \ \ \ \ \ \ \ eigen\_assert(m\_isInitialized\ \&\&\ \textcolor{stringliteral}{"{}RealQZ\ is\ not\ initialized."{}});}
\DoxyCodeLine{00150\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_T;}
\DoxyCodeLine{00151\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00160\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_real_q_z}{RealQZ}}\&\ \mbox{\hyperlink{class_eigen_1_1_real_q_z_a2b6847964d9f1903193cc3e67c196849}{compute}}(\textcolor{keyword}{const}\ MatrixType\&\ A,\ \textcolor{keyword}{const}\ MatrixType\&\ B,\ \textcolor{keywordtype}{bool}\ computeQZ\ =\ \textcolor{keyword}{true});}
\DoxyCodeLine{00161\ }
\DoxyCodeLine{00166\ \ \ \ \ \ \ \mbox{\hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo}}\ \mbox{\hyperlink{class_eigen_1_1_real_q_z_a36bd77afed89f3f5c110a715e69e4c64}{info}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00167\ \textcolor{keyword}{\ \ \ \ \ \ }\{}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ eigen\_assert(m\_isInitialized\ \&\&\ \textcolor{stringliteral}{"{}RealQZ\ is\ not\ initialized."{}});}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_info;}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00174\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_real_q_z_a6201e534e901b5f4e66f72c176b534a3}{Index}}\ \mbox{\hyperlink{class_eigen_1_1_real_q_z_afbecc6d0ab1de42be9db79428da48ab6}{iterations}}()\textcolor{keyword}{\ const}}
\DoxyCodeLine{00175\ \textcolor{keyword}{\ \ \ \ \ \ }\{}
\DoxyCodeLine{00176\ \ \ \ \ \ \ \ \ eigen\_assert(m\_isInitialized\ \&\&\ \textcolor{stringliteral}{"{}RealQZ\ is\ not\ initialized."{}});}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ m\_global\_iter;}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00179\ }
\DoxyCodeLine{00183\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_real_q_z}{RealQZ}}\&\ \mbox{\hyperlink{class_eigen_1_1_real_q_z_ab23916e1b60f0787cb3eb59a92d9c62b}{setMaxIterations}}(\mbox{\hyperlink{class_eigen_1_1_real_q_z_a6201e534e901b5f4e66f72c176b534a3}{Index}}\ maxIters)}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ m\_maxIters\ =\ maxIters;}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00188\ }
\DoxyCodeLine{00189\ \ \ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \ \ \ \ MatrixType\ m\_S,\ m\_T,\ m\_Q,\ m\_Z;}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,Dynamic,1>}}\ m\_workspace;}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \mbox{\hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo}}\ m\_info;}
\DoxyCodeLine{00194\ \ \ \ \ \ \ Index\ m\_maxIters;}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_isInitialized;}
\DoxyCodeLine{00196\ \ \ \ \ \ \ \textcolor{keywordtype}{bool}\ m\_computeQZ;}
\DoxyCodeLine{00197\ \ \ \ \ \ \ Scalar\ m\_normOfT,\ m\_normOfS;}
\DoxyCodeLine{00198\ \ \ \ \ \ \ Index\ m\_global\_iter;}
\DoxyCodeLine{00199\ }
\DoxyCodeLine{00200\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,3,1>}}\ Vector3s;}
\DoxyCodeLine{00201\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,2,1>}}\ Vector2s;}
\DoxyCodeLine{00202\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_matrix}{Matrix<Scalar,2,2>}}\ Matrix2s;}
\DoxyCodeLine{00203\ \ \ \ \ \ \ \textcolor{keyword}{typedef}\ \mbox{\hyperlink{class_eigen_1_1_jacobi_rotation}{JacobiRotation<Scalar>}}\ JRs;}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ hessenbergTriangular();}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ computeNorms();}
\DoxyCodeLine{00207\ \ \ \ \ \ \ Index\ findSmallSubdiagEntry(Index\ iu);}
\DoxyCodeLine{00208\ \ \ \ \ \ \ Index\ findSmallDiagEntry(Index\ f,\ Index\ l);}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ splitOffTwoRows(Index\ i);}
\DoxyCodeLine{00210\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ pushDownZero(Index\ z,\ Index\ f,\ Index\ l);}
\DoxyCodeLine{00211\ \ \ \ \ \ \ \textcolor{keywordtype}{void}\ step(Index\ f,\ Index\ l,\ Index\ iter);}
\DoxyCodeLine{00212\ }
\DoxyCodeLine{00213\ \ \ \};\ \textcolor{comment}{//\ RealQZ}}
\DoxyCodeLine{00214\ }
\DoxyCodeLine{00216\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00217\ \ \ \ \ \textcolor{keywordtype}{void}\ RealQZ<MatrixType>::hessenbergTriangular()}
\DoxyCodeLine{00218\ \ \ \ \ \{}
\DoxyCodeLine{00219\ }
\DoxyCodeLine{00220\ \ \ \ \ \ \ \textcolor{keyword}{const}\ Index\ dim\ =\ m\_S.cols();}
\DoxyCodeLine{00221\ }
\DoxyCodeLine{00222\ \ \ \ \ \ \ \textcolor{comment}{//\ perform\ QR\ decomposition\ of\ T,\ overwrite\ T\ with\ R,\ save\ Q}}
\DoxyCodeLine{00223\ \ \ \ \ \ \ HouseholderQR<MatrixType>\ qrT(m\_T);}
\DoxyCodeLine{00224\ \ \ \ \ \ \ m\_T\ =\ qrT.matrixQR();}
\DoxyCodeLine{00225\ \ \ \ \ \ \ m\_T.template\ triangularView<StrictlyLower>().setZero();}
\DoxyCodeLine{00226\ \ \ \ \ \ \ m\_Q\ =\ qrT.householderQ();}
\DoxyCodeLine{00227\ \ \ \ \ \ \ \textcolor{comment}{//\ overwrite\ S\ with\ Q*\ S}}
\DoxyCodeLine{00228\ \ \ \ \ \ \ m\_S.applyOnTheLeft(m\_Q.adjoint());}
\DoxyCodeLine{00229\ \ \ \ \ \ \ \textcolor{comment}{//\ init\ Z\ as\ Identity}}
\DoxyCodeLine{00230\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_computeQZ)}
\DoxyCodeLine{00231\ \ \ \ \ \ \ \ \ m\_Z\ =\ MatrixType::Identity(dim,dim);}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \textcolor{comment}{//\ reduce\ S\ to\ upper\ Hessenberg\ with\ Givens\ rotations}}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (Index\ j=0;\ j<=dim-\/3;\ j++)\ \{}
\DoxyCodeLine{00234\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (Index\ i=dim-\/1;\ i>=j+2;\ i-\/-\/)\ \{}
\DoxyCodeLine{00235\ \ \ \ \ \ \ \ \ \ \ JRs\ G;}
\DoxyCodeLine{00236\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ kill\ S(i,j)}}
\DoxyCodeLine{00237\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(m\_S.coeff(i,j)\ !=\ 0)}
\DoxyCodeLine{00238\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00239\ \ \ \ \ \ \ \ \ \ \ \ \ G.makeGivens(m\_S.coeff(i-\/1,j),\ m\_S.coeff(i,j),\ \&m\_S.coeffRef(i-\/1,\ j));}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \ \ \ \ \ \ m\_S.coeffRef(i,j)\ =\ Scalar(0.0);}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ m\_S.rightCols(dim-\/j-\/1).applyOnTheLeft(i-\/1,i,G.adjoint());}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ m\_T.rightCols(dim-\/i+1).applyOnTheLeft(i-\/1,i,G.adjoint());}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ update\ Q}}
\DoxyCodeLine{00244\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_computeQZ)}
\DoxyCodeLine{00245\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_Q.applyOnTheRight(i-\/1,i,G);}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ kill\ T(i,i-\/1)}}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(m\_T.coeff(i,i-\/1)!=Scalar(0))}
\DoxyCodeLine{00249\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ G.makeGivens(m\_T.coeff(i,i),\ m\_T.coeff(i,i-\/1),\ \&m\_T.coeffRef(i,i));}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ m\_T.coeffRef(i,i-\/1)\ =\ Scalar(0.0);}
\DoxyCodeLine{00252\ \ \ \ \ \ \ \ \ \ \ \ \ m\_S.applyOnTheRight(i,i-\/1,G);}
\DoxyCodeLine{00253\ \ \ \ \ \ \ \ \ \ \ \ \ m\_T.topRows(i).applyOnTheRight(i,i-\/1,G);}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ update\ Z}}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_computeQZ)}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_Z.applyOnTheLeft(i,i-\/1,G.adjoint());}
\DoxyCodeLine{00257\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00258\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00259\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00260\ \ \ \ \ \}}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00263\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00264\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ RealQZ<MatrixType>::computeNorms()}
\DoxyCodeLine{00265\ \ \ \ \ \{}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \textcolor{keyword}{const}\ Index\ size\ =\ m\_S.cols();}
\DoxyCodeLine{00267\ \ \ \ \ \ \ m\_normOfS\ =\ Scalar(0.0);}
\DoxyCodeLine{00268\ \ \ \ \ \ \ m\_normOfT\ =\ Scalar(0.0);}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (Index\ j\ =\ 0;\ j\ <\ size;\ ++j)}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ m\_normOfS\ +=\ m\_S.col(j).segment(0,\ (std::min)(size,j+2)).cwiseAbs().sum();}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ m\_normOfT\ +=\ m\_T.row(j).segment(j,\ size\ -\/\ j).cwiseAbs().sum();}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00274\ \ \ \ \ \}}
\DoxyCodeLine{00275\ }
\DoxyCodeLine{00276\ }
\DoxyCodeLine{00278\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00279\ \ \ \ \ \textcolor{keyword}{inline}\ Index\ RealQZ<MatrixType>::findSmallSubdiagEntry(Index\ iu)}
\DoxyCodeLine{00280\ \ \ \ \ \{}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00282\ \ \ \ \ \ \ Index\ res\ =\ iu;}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (res\ >\ 0)}
\DoxyCodeLine{00284\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ Scalar\ s\ =\ abs(m\_S.coeff(res-\/1,res-\/1))\ +\ abs(m\_S.coeff(res,res));}
\DoxyCodeLine{00286\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (s\ ==\ Scalar(0.0))}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \ \ \ \ s\ =\ m\_normOfS;}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (abs(m\_S.coeff(res,res-\/1))\ <\ NumTraits<Scalar>::epsilon()\ *\ s)}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ res-\/-\/;}
\DoxyCodeLine{00291\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00293\ \ \ \ \ \}}
\DoxyCodeLine{00294\ }
\DoxyCodeLine{00296\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00297\ \ \ \ \ \textcolor{keyword}{inline}\ Index\ RealQZ<MatrixType>::findSmallDiagEntry(Index\ f,\ Index\ l)}
\DoxyCodeLine{00298\ \ \ \ \ \{}
\DoxyCodeLine{00299\ \ \ \ \ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00300\ \ \ \ \ \ \ Index\ res\ =\ l;}
\DoxyCodeLine{00301\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (res\ >=\ f)\ \{}
\DoxyCodeLine{00302\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (abs(m\_T.coeff(res,res))\ <=\ NumTraits<Scalar>::epsilon()\ *\ m\_normOfT)}
\DoxyCodeLine{00303\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{break};}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \ \ res-\/-\/;}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ res;}
\DoxyCodeLine{00307\ \ \ \ \ \}}
\DoxyCodeLine{00308\ }
\DoxyCodeLine{00310\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00311\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ RealQZ<MatrixType>::splitOffTwoRows(Index\ i)}
\DoxyCodeLine{00312\ \ \ \ \ \{}
\DoxyCodeLine{00313\ \ \ \ \ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00314\ \ \ \ \ \ \ \textcolor{keyword}{using\ }std::sqrt;}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \textcolor{keyword}{const}\ Index\ dim=m\_S.cols();}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (abs(m\_S.coeff(i+1,i))==Scalar(0))}
\DoxyCodeLine{00317\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return};}
\DoxyCodeLine{00318\ \ \ \ \ \ \ Index\ j\ =\ findSmallDiagEntry(i,i+1);}
\DoxyCodeLine{00319\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (j==i-\/1)}
\DoxyCodeLine{00320\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00321\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ block\ of\ (S\ T\string^\{-\/1\})}}
\DoxyCodeLine{00322\ \ \ \ \ \ \ \ \ Matrix2s\ STi\ =\ m\_T.template\ block<2,2>(i,i).template\ triangularView<Upper>().}
\DoxyCodeLine{00323\ \ \ \ \ \ \ \ \ \ \ \textcolor{keyword}{template}\ solve<OnTheRight>(m\_S.template\ block<2,2>(i,i));}
\DoxyCodeLine{00324\ \ \ \ \ \ \ \ \ Scalar\ p\ =\ Scalar(0.5)*(STi(0,0)-\/STi(1,1));}
\DoxyCodeLine{00325\ \ \ \ \ \ \ \ \ Scalar\ q\ =\ p*p\ +\ STi(1,0)*STi(0,1);}
\DoxyCodeLine{00326\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (q>=0)\ \{}
\DoxyCodeLine{00327\ \ \ \ \ \ \ \ \ \ \ Scalar\ z\ =\ sqrt(q);}
\DoxyCodeLine{00328\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ one\ QR-\/like\ iteration\ for\ ABi\ -\/\ lambda\ I}}
\DoxyCodeLine{00329\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ is\ enough\ -\/\ when\ we\ know\ exact\ eigenvalue\ in\ advance,}}
\DoxyCodeLine{00330\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ convergence\ is\ immediate}}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ JRs\ G;}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (p>=0)}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ G.makeGivens(p\ +\ z,\ STi(1,0));}
\DoxyCodeLine{00334\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ \ \ \ \ G.makeGivens(p\ -\/\ z,\ STi(1,0));}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ m\_S.rightCols(dim-\/i).applyOnTheLeft(i,i+1,G.adjoint());}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ m\_T.rightCols(dim-\/i).applyOnTheLeft(i,i+1,G.adjoint());}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ update\ Q}}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_computeQZ)}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ m\_Q.applyOnTheRight(i,i+1,G);}
\DoxyCodeLine{00341\ }
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ G.makeGivens(m\_T.coeff(i+1,i+1),\ m\_T.coeff(i+1,i));}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ \ \ m\_S.topRows(i+2).applyOnTheRight(i+1,i,G);}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ \ \ m\_T.topRows(i+2).applyOnTheRight(i+1,i,G);}
\DoxyCodeLine{00345\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ update\ Z}}
\DoxyCodeLine{00346\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_computeQZ)}
\DoxyCodeLine{00347\ \ \ \ \ \ \ \ \ \ \ \ \ m\_Z.applyOnTheLeft(i+1,i,G.adjoint());}
\DoxyCodeLine{00348\ }
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ m\_S.coeffRef(i+1,i)\ =\ Scalar(0.0);}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ m\_T.coeffRef(i+1,i)\ =\ Scalar(0.0);}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00354\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00355\ \ \ \ \ \ \ \ \ pushDownZero(j,i,i+1);}
\DoxyCodeLine{00356\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00357\ \ \ \ \ \}}
\DoxyCodeLine{00358\ }
\DoxyCodeLine{00360\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00361\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ RealQZ<MatrixType>::pushDownZero(Index\ z,\ Index\ f,\ Index\ l)}
\DoxyCodeLine{00362\ \ \ \ \ \{}
\DoxyCodeLine{00363\ \ \ \ \ \ \ JRs\ G;}
\DoxyCodeLine{00364\ \ \ \ \ \ \ \textcolor{keyword}{const}\ Index\ dim\ =\ m\_S.cols();}
\DoxyCodeLine{00365\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (Index\ zz=z;\ zz<l;\ zz++)}
\DoxyCodeLine{00366\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00367\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ push\ 0\ down}}
\DoxyCodeLine{00368\ \ \ \ \ \ \ \ \ Index\ firstColS\ =\ zz>f\ ?\ (zz-\/1)\ :\ zz;}
\DoxyCodeLine{00369\ \ \ \ \ \ \ \ \ G.makeGivens(m\_T.coeff(zz,\ zz+1),\ m\_T.coeff(zz+1,\ zz+1));}
\DoxyCodeLine{00370\ \ \ \ \ \ \ \ \ m\_S.rightCols(dim-\/firstColS).applyOnTheLeft(zz,zz+1,G.adjoint());}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \ \ m\_T.rightCols(dim-\/zz).applyOnTheLeft(zz,zz+1,G.adjoint());}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ m\_T.coeffRef(zz+1,zz+1)\ =\ Scalar(0.0);}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ update\ Q}}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_computeQZ)}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ m\_Q.applyOnTheRight(zz,zz+1,G);}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ kill\ S(zz+1,\ zz-\/1)}}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (zz>f)}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ G.makeGivens(m\_S.coeff(zz+1,\ zz),\ m\_S.coeff(zz+1,zz-\/1));}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ m\_S.topRows(zz+2).applyOnTheRight(zz,\ zz-\/1,G);}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ m\_T.topRows(zz+1).applyOnTheRight(zz,\ zz-\/1,G);}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ \ \ m\_S.coeffRef(zz+1,zz-\/1)\ =\ Scalar(0.0);}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ update\ Z}}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_computeQZ)}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ \ \ \ \ m\_Z.applyOnTheLeft(zz,zz-\/1,G.adjoint());}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \textcolor{comment}{//\ finally\ kill\ S(l,l-\/1)}}
\DoxyCodeLine{00389\ \ \ \ \ \ \ G.makeGivens(m\_S.coeff(l,l),\ m\_S.coeff(l,l-\/1));}
\DoxyCodeLine{00390\ \ \ \ \ \ \ m\_S.applyOnTheRight(l,l-\/1,G);}
\DoxyCodeLine{00391\ \ \ \ \ \ \ m\_T.applyOnTheRight(l,l-\/1,G);}
\DoxyCodeLine{00392\ \ \ \ \ \ \ m\_S.coeffRef(l,l-\/1)=Scalar(0.0);}
\DoxyCodeLine{00393\ \ \ \ \ \ \ \textcolor{comment}{//\ update\ Z}}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_computeQZ)}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ m\_Z.applyOnTheLeft(l,l-\/1,G.adjoint());}
\DoxyCodeLine{00396\ \ \ \ \ \}}
\DoxyCodeLine{00397\ }
\DoxyCodeLine{00399\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00400\ \ \ \ \ \textcolor{keyword}{inline}\ \textcolor{keywordtype}{void}\ RealQZ<MatrixType>::step(Index\ f,\ Index\ l,\ Index\ iter)}
\DoxyCodeLine{00401\ \ \ \ \ \{}
\DoxyCodeLine{00402\ \ \ \ \ \ \ \textcolor{keyword}{using\ }std::abs;}
\DoxyCodeLine{00403\ \ \ \ \ \ \ \textcolor{keyword}{const}\ Index\ dim\ =\ m\_S.cols();}
\DoxyCodeLine{00404\ }
\DoxyCodeLine{00405\ \ \ \ \ \ \ \textcolor{comment}{//\ x,\ y,\ z}}
\DoxyCodeLine{00406\ \ \ \ \ \ \ Scalar\ x,\ y,\ z;}
\DoxyCodeLine{00407\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (iter==10)}
\DoxyCodeLine{00408\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00409\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Wilkinson\ ad\ hoc\ shift}}
\DoxyCodeLine{00410\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Scalar}
\DoxyCodeLine{00411\ \ \ \ \ \ \ \ \ \ \ a11=m\_S.coeff(f+0,f+0),\ a12=m\_S.coeff(f+0,f+1),}
\DoxyCodeLine{00412\ \ \ \ \ \ \ \ \ \ \ a21=m\_S.coeff(f+1,f+0),\ a22=m\_S.coeff(f+1,f+1),\ a32=m\_S.coeff(f+2,f+1),}
\DoxyCodeLine{00413\ \ \ \ \ \ \ \ \ \ \ b12=m\_T.coeff(f+0,f+1),}
\DoxyCodeLine{00414\ \ \ \ \ \ \ \ \ \ \ b11i=Scalar(1.0)/m\_T.coeff(f+0,f+0),}
\DoxyCodeLine{00415\ \ \ \ \ \ \ \ \ \ \ b22i=Scalar(1.0)/m\_T.coeff(f+1,f+1),}
\DoxyCodeLine{00416\ \ \ \ \ \ \ \ \ \ \ a87=m\_S.coeff(l-\/1,l-\/2),}
\DoxyCodeLine{00417\ \ \ \ \ \ \ \ \ \ \ a98=m\_S.coeff(l-\/0,l-\/1),}
\DoxyCodeLine{00418\ \ \ \ \ \ \ \ \ \ \ b77i=Scalar(1.0)/m\_T.coeff(l-\/2,l-\/2),}
\DoxyCodeLine{00419\ \ \ \ \ \ \ \ \ \ \ b88i=Scalar(1.0)/m\_T.coeff(l-\/1,l-\/1);}
\DoxyCodeLine{00420\ \ \ \ \ \ \ \ \ Scalar\ ss\ =\ abs(a87*b77i)\ +\ abs(a98*b88i),}
\DoxyCodeLine{00421\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ lpl\ =\ Scalar(1.5)*ss,}
\DoxyCodeLine{00422\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ ll\ =\ ss*ss;}
\DoxyCodeLine{00423\ \ \ \ \ \ \ \ \ x\ =\ ll\ +\ a11*a11*b11i*b11i\ -\/\ lpl*a11*b11i\ +\ a12*a21*b11i*b22i}
\DoxyCodeLine{00424\ \ \ \ \ \ \ \ \ \ \ -\/\ a11*a21*b12*b11i*b11i*b22i;}
\DoxyCodeLine{00425\ \ \ \ \ \ \ \ \ y\ =\ a11*a21*b11i*b11i\ -\/\ lpl*a21*b11i\ +\ a21*a22*b11i*b22i\ }
\DoxyCodeLine{00426\ \ \ \ \ \ \ \ \ \ \ -\/\ a21*a21*b12*b11i*b11i*b22i;}
\DoxyCodeLine{00427\ \ \ \ \ \ \ \ \ z\ =\ a21*a32*b11i*b22i;}
\DoxyCodeLine{00428\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00429\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (iter==16)}
\DoxyCodeLine{00430\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00431\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ another\ exceptional\ shift}}
\DoxyCodeLine{00432\ \ \ \ \ \ \ \ \ x\ =\ m\_S.coeff(f,f)/m\_T.coeff(f,f)-\/m\_S.coeff(l,l)/m\_T.coeff(l,l)\ +\ m\_S.coeff(l,l-\/1)*m\_T.coeff(l-\/1,l)\ /}
\DoxyCodeLine{00433\ \ \ \ \ \ \ \ \ \ \ (m\_T.coeff(l-\/1,l-\/1)*m\_T.coeff(l,l));}
\DoxyCodeLine{00434\ \ \ \ \ \ \ \ \ y\ =\ m\_S.coeff(f+1,f)/m\_T.coeff(f,f);}
\DoxyCodeLine{00435\ \ \ \ \ \ \ \ \ z\ =\ 0;}
\DoxyCodeLine{00436\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00437\ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (iter>23\ \&\&\ !(iter\%8))}
\DoxyCodeLine{00438\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00439\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ extremely\ exceptional\ shift}}
\DoxyCodeLine{00440\ \ \ \ \ \ \ \ \ x\ =\ internal::random<Scalar>(-\/1.0,1.0);}
\DoxyCodeLine{00441\ \ \ \ \ \ \ \ \ y\ =\ internal::random<Scalar>(-\/1.0,1.0);}
\DoxyCodeLine{00442\ \ \ \ \ \ \ \ \ z\ =\ internal::random<Scalar>(-\/1.0,1.0);}
\DoxyCodeLine{00443\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00444\ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00445\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00446\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Compute\ the\ shifts:\ (x,y,z,0...)\ =\ (AB\string^-\/1\ -\/\ l1\ I)\ (AB\string^-\/1\ -\/\ l2\ I)\ e1}}
\DoxyCodeLine{00447\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ where\ l1\ and\ l2\ are\ the\ eigenvalues\ of\ the\ 2x2\ matrix\ C\ =\ U\ V\string^-\/1\ where}}
\DoxyCodeLine{00448\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ U\ and\ V\ are\ 2x2\ bottom\ right\ sub\ matrices\ of\ A\ and\ B.\ Thus:}}
\DoxyCodeLine{00449\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ =\ AB\string^-\/1AB\string^-\/1\ +\ l1\ l2\ I\ -\/\ (l1+l2)(AB\string^-\/1)}}
\DoxyCodeLine{00450\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ \ =\ AB\string^-\/1AB\string^-\/1\ +\ det(M)\ -\/\ tr(M)(AB\string^-\/1)}}
\DoxyCodeLine{00451\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Since\ we\ are\ only\ interested\ in\ having\ x,\ y,\ z\ with\ a\ correct\ ratio,\ we\ have:}}
\DoxyCodeLine{00452\ \ \ \ \ \ \ \ \ \textcolor{keyword}{const}\ Scalar}
\DoxyCodeLine{00453\ \ \ \ \ \ \ \ \ \ \ a11\ =\ m\_S.coeff(f,f),\ \ \ \ \ a12\ =\ m\_S.coeff(f,f+1),}
\DoxyCodeLine{00454\ \ \ \ \ \ \ \ \ \ \ a21\ =\ m\_S.coeff(f+1,f),\ \ \ a22\ =\ m\_S.coeff(f+1,f+1),}
\DoxyCodeLine{00455\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ a32\ =\ m\_S.coeff(f+2,f+1),}
\DoxyCodeLine{00456\ }
\DoxyCodeLine{00457\ \ \ \ \ \ \ \ \ \ \ a88\ =\ m\_S.coeff(l-\/1,l-\/1),\ a89\ =\ m\_S.coeff(l-\/1,l),}
\DoxyCodeLine{00458\ \ \ \ \ \ \ \ \ \ \ a98\ =\ m\_S.coeff(l,l-\/1),\ \ \ a99\ =\ m\_S.coeff(l,l),}
\DoxyCodeLine{00459\ }
\DoxyCodeLine{00460\ \ \ \ \ \ \ \ \ \ \ b11\ =\ m\_T.coeff(f,f),\ \ \ \ \ b12\ =\ m\_T.coeff(f,f+1),}
\DoxyCodeLine{00461\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b22\ =\ m\_T.coeff(f+1,f+1),}
\DoxyCodeLine{00462\ }
\DoxyCodeLine{00463\ \ \ \ \ \ \ \ \ \ \ b88\ =\ m\_T.coeff(l-\/1,l-\/1),\ b89\ =\ m\_T.coeff(l-\/1,l),}
\DoxyCodeLine{00464\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ b99\ =\ m\_T.coeff(l,l);}
\DoxyCodeLine{00465\ }
\DoxyCodeLine{00466\ \ \ \ \ \ \ \ \ x\ =\ (\ (a88/b88\ -\/\ a11/b11)*(a99/b99\ -\/\ a11/b11)\ -\/\ (a89/b99)*(a98/b88)\ +\ (a98/b88)*(b89/b99)*(a11/b11)\ )\ *\ (b11/a21)}
\DoxyCodeLine{00467\ \ \ \ \ \ \ \ \ \ \ +\ a12/b22\ -\/\ (a11/b11)*(b12/b22);}
\DoxyCodeLine{00468\ \ \ \ \ \ \ \ \ y\ =\ (a22/b22-\/a11/b11)\ -\/\ (a21/b11)*(b12/b22)\ -\/\ (a88/b88-\/a11/b11)\ -\/\ (a99/b99-\/a11/b11)\ +\ (a98/b88)*(b89/b99);}
\DoxyCodeLine{00469\ \ \ \ \ \ \ \ \ z\ =\ a32/b22;}
\DoxyCodeLine{00470\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00471\ }
\DoxyCodeLine{00472\ \ \ \ \ \ \ JRs\ G;}
\DoxyCodeLine{00473\ }
\DoxyCodeLine{00474\ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ (Index\ k=f;\ k<=l-\/2;\ k++)}
\DoxyCodeLine{00475\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00476\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ variables\ for\ Householder\ reflections}}
\DoxyCodeLine{00477\ \ \ \ \ \ \ \ \ Vector2s\ essential2;}
\DoxyCodeLine{00478\ \ \ \ \ \ \ \ \ Scalar\ tau,\ beta;}
\DoxyCodeLine{00479\ }
\DoxyCodeLine{00480\ \ \ \ \ \ \ \ \ Vector3s\ hr(x,y,z);}
\DoxyCodeLine{00481\ }
\DoxyCodeLine{00482\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Q\_k\ to\ annihilate\ S(k+1,k-\/1)\ and\ S(k+2,k-\/1)}}
\DoxyCodeLine{00483\ \ \ \ \ \ \ \ \ hr.makeHouseholderInPlace(tau,\ beta);}
\DoxyCodeLine{00484\ \ \ \ \ \ \ \ \ essential2\ =\ hr.template\ bottomRows<2>();}
\DoxyCodeLine{00485\ \ \ \ \ \ \ \ \ Index\ fc=(std::max)(k-\/1,Index(0));\ \ \textcolor{comment}{//\ first\ col\ to\ update}}
\DoxyCodeLine{00486\ \ \ \ \ \ \ \ \ m\_S.template\ middleRows<3>(k).rightCols(dim-\/fc).applyHouseholderOnTheLeft(essential2,\ tau,\ m\_workspace.data());}
\DoxyCodeLine{00487\ \ \ \ \ \ \ \ \ m\_T.template\ middleRows<3>(k).rightCols(dim-\/fc).applyHouseholderOnTheLeft(essential2,\ tau,\ m\_workspace.data());}
\DoxyCodeLine{00488\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_computeQZ)}
\DoxyCodeLine{00489\ \ \ \ \ \ \ \ \ \ \ m\_Q.template\ middleCols<3>(k).applyHouseholderOnTheRight(essential2,\ tau,\ m\_workspace.data());}
\DoxyCodeLine{00490\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k>f)}
\DoxyCodeLine{00491\ \ \ \ \ \ \ \ \ \ \ m\_S.coeffRef(k+2,k-\/1)\ =\ m\_S.coeffRef(k+1,k-\/1)\ =\ Scalar(0.0);}
\DoxyCodeLine{00492\ }
\DoxyCodeLine{00493\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Z\_\{k1\}\ to\ annihilate\ T(k+2,k+1)\ and\ T(k+2,k)}}
\DoxyCodeLine{00494\ \ \ \ \ \ \ \ \ hr\ <<\ m\_T.coeff(k+2,k+2),m\_T.coeff(k+2,k),m\_T.coeff(k+2,k+1);}
\DoxyCodeLine{00495\ \ \ \ \ \ \ \ \ hr.makeHouseholderInPlace(tau,\ beta);}
\DoxyCodeLine{00496\ \ \ \ \ \ \ \ \ essential2\ =\ hr.template\ bottomRows<2>();}
\DoxyCodeLine{00497\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00498\ \ \ \ \ \ \ \ \ \ \ Index\ lr\ =\ (std::min)(k+4,dim);\ \textcolor{comment}{//\ last\ row\ to\ update}}
\DoxyCodeLine{00499\ \ \ \ \ \ \ \ \ \ \ Map<Matrix<Scalar,Dynamic,1>\ >\ tmp(m\_workspace.data(),lr);}
\DoxyCodeLine{00500\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ S}}
\DoxyCodeLine{00501\ \ \ \ \ \ \ \ \ \ \ tmp\ =\ m\_S.template\ middleCols<2>(k).topRows(lr)\ *\ essential2;}
\DoxyCodeLine{00502\ \ \ \ \ \ \ \ \ \ \ tmp\ +=\ m\_S.col(k+2).head(lr);}
\DoxyCodeLine{00503\ \ \ \ \ \ \ \ \ \ \ m\_S.col(k+2).head(lr)\ -\/=\ tau*tmp;}
\DoxyCodeLine{00504\ \ \ \ \ \ \ \ \ \ \ m\_S.template\ middleCols<2>(k).topRows(lr)\ -\/=\ (tau*tmp)\ *\ essential2.adjoint();}
\DoxyCodeLine{00505\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ T}}
\DoxyCodeLine{00506\ \ \ \ \ \ \ \ \ \ \ tmp\ =\ m\_T.template\ middleCols<2>(k).topRows(lr)\ *\ essential2;}
\DoxyCodeLine{00507\ \ \ \ \ \ \ \ \ \ \ tmp\ +=\ m\_T.col(k+2).head(lr);}
\DoxyCodeLine{00508\ \ \ \ \ \ \ \ \ \ \ m\_T.col(k+2).head(lr)\ -\/=\ tau*tmp;}
\DoxyCodeLine{00509\ \ \ \ \ \ \ \ \ \ \ m\_T.template\ middleCols<2>(k).topRows(lr)\ -\/=\ (tau*tmp)\ *\ essential2.adjoint();}
\DoxyCodeLine{00510\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00511\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_computeQZ)}
\DoxyCodeLine{00512\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00513\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Z}}
\DoxyCodeLine{00514\ \ \ \ \ \ \ \ \ \ \ Map<Matrix<Scalar,1,Dynamic>\ >\ tmp(m\_workspace.data(),dim);}
\DoxyCodeLine{00515\ \ \ \ \ \ \ \ \ \ \ tmp\ =\ essential2.adjoint()*(m\_Z.template\ middleRows<2>(k));}
\DoxyCodeLine{00516\ \ \ \ \ \ \ \ \ \ \ tmp\ +=\ m\_Z.row(k+2);}
\DoxyCodeLine{00517\ \ \ \ \ \ \ \ \ \ \ m\_Z.row(k+2)\ -\/=\ tau*tmp;}
\DoxyCodeLine{00518\ \ \ \ \ \ \ \ \ \ \ m\_Z.template\ middleRows<2>(k)\ -\/=\ essential2\ *\ (tau*tmp);}
\DoxyCodeLine{00519\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00520\ \ \ \ \ \ \ \ \ m\_T.coeffRef(k+2,k)\ =\ m\_T.coeffRef(k+2,k+1)\ =\ Scalar(0.0);}
\DoxyCodeLine{00521\ }
\DoxyCodeLine{00522\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Z\_\{k2\}\ to\ annihilate\ T(k+1,k)}}
\DoxyCodeLine{00523\ \ \ \ \ \ \ \ \ G.makeGivens(m\_T.coeff(k+1,k+1),\ m\_T.coeff(k+1,k));}
\DoxyCodeLine{00524\ \ \ \ \ \ \ \ \ m\_S.applyOnTheRight(k+1,k,G);}
\DoxyCodeLine{00525\ \ \ \ \ \ \ \ \ m\_T.applyOnTheRight(k+1,k,G);}
\DoxyCodeLine{00526\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ update\ Z}}
\DoxyCodeLine{00527\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_computeQZ)}
\DoxyCodeLine{00528\ \ \ \ \ \ \ \ \ \ \ m\_Z.applyOnTheLeft(k+1,k,G.adjoint());}
\DoxyCodeLine{00529\ \ \ \ \ \ \ \ \ m\_T.coeffRef(k+1,k)\ =\ Scalar(0.0);}
\DoxyCodeLine{00530\ }
\DoxyCodeLine{00531\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ update\ x,y,z}}
\DoxyCodeLine{00532\ \ \ \ \ \ \ \ \ x\ =\ m\_S.coeff(k+1,k);}
\DoxyCodeLine{00533\ \ \ \ \ \ \ \ \ y\ =\ m\_S.coeff(k+2,k);}
\DoxyCodeLine{00534\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (k\ <\ l-\/2)}
\DoxyCodeLine{00535\ \ \ \ \ \ \ \ \ \ \ z\ =\ m\_S.coeff(k+3,k);}
\DoxyCodeLine{00536\ \ \ \ \ \ \ \}\ \textcolor{comment}{//\ loop\ over\ k}}
\DoxyCodeLine{00537\ }
\DoxyCodeLine{00538\ \ \ \ \ \ \ \textcolor{comment}{//\ Q\_\{n-\/1\}\ to\ annihilate\ y\ =\ S(l,l-\/2)}}
\DoxyCodeLine{00539\ \ \ \ \ \ \ G.makeGivens(x,y);}
\DoxyCodeLine{00540\ \ \ \ \ \ \ m\_S.applyOnTheLeft(l-\/1,l,G.adjoint());}
\DoxyCodeLine{00541\ \ \ \ \ \ \ m\_T.applyOnTheLeft(l-\/1,l,G.adjoint());}
\DoxyCodeLine{00542\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_computeQZ)}
\DoxyCodeLine{00543\ \ \ \ \ \ \ \ \ m\_Q.applyOnTheRight(l-\/1,l,G);}
\DoxyCodeLine{00544\ \ \ \ \ \ \ m\_S.coeffRef(l,l-\/2)\ =\ Scalar(0.0);}
\DoxyCodeLine{00545\ }
\DoxyCodeLine{00546\ \ \ \ \ \ \ \textcolor{comment}{//\ Z\_\{n-\/1\}\ to\ annihilate\ T(l,l-\/1)}}
\DoxyCodeLine{00547\ \ \ \ \ \ \ G.makeGivens(m\_T.coeff(l,l),m\_T.coeff(l,l-\/1));}
\DoxyCodeLine{00548\ \ \ \ \ \ \ m\_S.applyOnTheRight(l,l-\/1,G);}
\DoxyCodeLine{00549\ \ \ \ \ \ \ m\_T.applyOnTheRight(l,l-\/1,G);}
\DoxyCodeLine{00550\ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (m\_computeQZ)}
\DoxyCodeLine{00551\ \ \ \ \ \ \ \ \ m\_Z.applyOnTheLeft(l,l-\/1,G.adjoint());}
\DoxyCodeLine{00552\ \ \ \ \ \ \ m\_T.coeffRef(l,l-\/1)\ =\ Scalar(0.0);}
\DoxyCodeLine{00553\ \ \ \ \ \}}
\DoxyCodeLine{00554\ }
\DoxyCodeLine{00555\ \ \ \textcolor{keyword}{template}<\textcolor{keyword}{typename}\ MatrixType>}
\DoxyCodeLine{00556\ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_real_q_z}{RealQZ<MatrixType>}}\&\ \mbox{\hyperlink{class_eigen_1_1_real_q_z_a2b6847964d9f1903193cc3e67c196849}{RealQZ<MatrixType>::compute}}(\textcolor{keyword}{const}\ MatrixType\&\ A\_in,\ \textcolor{keyword}{const}\ MatrixType\&\ B\_in,\ \textcolor{keywordtype}{bool}\ computeQZ)}
\DoxyCodeLine{00557\ \ \ \ \ \{}
\DoxyCodeLine{00558\ }
\DoxyCodeLine{00559\ \ \ \ \ \ \ \textcolor{keyword}{const}\ \mbox{\hyperlink{class_eigen_1_1_real_q_z_a6201e534e901b5f4e66f72c176b534a3}{Index}}\ dim\ =\ A\_in.cols();}
\DoxyCodeLine{00560\ }
\DoxyCodeLine{00561\ \ \ \ \ \ \ eigen\_assert\ (A\_in.rows()==dim\ \&\&\ A\_in.cols()==dim\ }
\DoxyCodeLine{00562\ \ \ \ \ \ \ \ \ \ \ \&\&\ B\_in.rows()==dim\ \&\&\ B\_in.cols()==dim\ }
\DoxyCodeLine{00563\ \ \ \ \ \ \ \ \ \ \ \&\&\ \textcolor{stringliteral}{"{}Need\ square\ matrices\ of\ the\ same\ dimension"{}});}
\DoxyCodeLine{00564\ }
\DoxyCodeLine{00565\ \ \ \ \ \ \ m\_isInitialized\ =\ \textcolor{keyword}{true};}
\DoxyCodeLine{00566\ \ \ \ \ \ \ m\_computeQZ\ =\ computeQZ;}
\DoxyCodeLine{00567\ \ \ \ \ \ \ m\_S\ =\ A\_in;\ m\_T\ =\ B\_in;}
\DoxyCodeLine{00568\ \ \ \ \ \ \ m\_workspace.resize(dim*2);}
\DoxyCodeLine{00569\ \ \ \ \ \ \ m\_global\_iter\ =\ 0;}
\DoxyCodeLine{00570\ }
\DoxyCodeLine{00571\ \ \ \ \ \ \ \textcolor{comment}{//\ entrance\ point:\ hessenberg\ triangular\ decomposition}}
\DoxyCodeLine{00572\ \ \ \ \ \ \ hessenbergTriangular();}
\DoxyCodeLine{00573\ \ \ \ \ \ \ \textcolor{comment}{//\ compute\ L1\ vector\ norms\ of\ T,\ S\ into\ m\_normOfS,\ m\_normOfT}}
\DoxyCodeLine{00574\ \ \ \ \ \ \ computeNorms();}
\DoxyCodeLine{00575\ }
\DoxyCodeLine{00576\ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_real_q_z_a6201e534e901b5f4e66f72c176b534a3}{Index}}\ l\ =\ dim-\/1,\ }
\DoxyCodeLine{00577\ \ \ \ \ \ \ \ \ \ \ \ \ f,\ }
\DoxyCodeLine{00578\ \ \ \ \ \ \ \ \ \ \ \ \ local\_iter\ =\ 0;}
\DoxyCodeLine{00579\ }
\DoxyCodeLine{00580\ \ \ \ \ \ \ \textcolor{keywordflow}{while}\ (l>0\ \&\&\ local\_iter<m\_maxIters)}
\DoxyCodeLine{00581\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00582\ \ \ \ \ \ \ \ \ f\ =\ findSmallSubdiagEntry(l);}
\DoxyCodeLine{00583\ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ now\ rows\ and\ columns\ f..l\ (including)\ decouple\ from\ the\ rest\ of\ the\ problem}}
\DoxyCodeLine{00584\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (f>0)\ m\_S.coeffRef(f,f-\/1)\ =\ Scalar(0.0);}
\DoxyCodeLine{00585\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (f\ ==\ l)\ \textcolor{comment}{//\ One\ root\ found}}
\DoxyCodeLine{00586\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00587\ \ \ \ \ \ \ \ \ \ \ l-\/-\/;}
\DoxyCodeLine{00588\ \ \ \ \ \ \ \ \ \ \ local\_iter\ =\ 0;}
\DoxyCodeLine{00589\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00590\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{keywordflow}{if}\ (f\ ==\ l-\/1)\ \textcolor{comment}{//\ Two\ roots\ found}}
\DoxyCodeLine{00591\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00592\ \ \ \ \ \ \ \ \ \ \ splitOffTwoRows(f);}
\DoxyCodeLine{00593\ \ \ \ \ \ \ \ \ \ \ l\ -\/=\ 2;}
\DoxyCodeLine{00594\ \ \ \ \ \ \ \ \ \ \ local\_iter\ =\ 0;}
\DoxyCodeLine{00595\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00596\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}\ \textcolor{comment}{//\ No\ convergence\ yet}}
\DoxyCodeLine{00597\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00598\ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ if\ there's\ zero\ on\ diagonal\ of\ T,\ we\ can\ isolate\ an\ eigenvalue\ with\ Givens\ rotations}}
\DoxyCodeLine{00599\ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_real_q_z_a6201e534e901b5f4e66f72c176b534a3}{Index}}\ z\ =\ findSmallDiagEntry(f,l);}
\DoxyCodeLine{00600\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}\ (z>=f)}
\DoxyCodeLine{00601\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00602\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ zero\ found}}
\DoxyCodeLine{00603\ \ \ \ \ \ \ \ \ \ \ \ \ pushDownZero(z,f,l);}
\DoxyCodeLine{00604\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00605\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{else}}
\DoxyCodeLine{00606\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00607\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ We\ are\ sure\ now\ that\ S.block(f,f,\ l-\/f+1,l-\/f+1)\ is\ underuced\ upper-\/Hessenberg\ }}
\DoxyCodeLine{00608\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ and\ T.block(f,f,\ l-\/f+1,l-\/f+1)\ is\ invertible\ uper-\/triangular,\ which\ allows\ to}}
\DoxyCodeLine{00609\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ apply\ a\ QR-\/like\ iteration\ to\ rows\ and\ columns\ f..l.}}
\DoxyCodeLine{00610\ \ \ \ \ \ \ \ \ \ \ \ \ step(f,l,\ local\_iter);}
\DoxyCodeLine{00611\ \ \ \ \ \ \ \ \ \ \ \ \ local\_iter++;}
\DoxyCodeLine{00612\ \ \ \ \ \ \ \ \ \ \ \ \ m\_global\_iter++;}
\DoxyCodeLine{00613\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00614\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00615\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00616\ \ \ \ \ \ \ \textcolor{comment}{//\ check\ if\ we\ converged\ before\ reaching\ iterations\ limit}}
\DoxyCodeLine{00617\ \ \ \ \ \ \ m\_info\ =\ (local\_iter<m\_maxIters)\ ?\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}}\ :\ \mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea6a68dfb88a8336108a30588bdf356c57}{NoConvergence}};}
\DoxyCodeLine{00618\ }
\DoxyCodeLine{00619\ \ \ \ \ \ \ \textcolor{comment}{//\ For\ each\ non\ triangular\ 2x2\ diagonal\ block\ of\ S,}}
\DoxyCodeLine{00620\ \ \ \ \ \ \ \textcolor{comment}{//\ \ \ \ reduce\ the\ respective\ 2x2\ diagonal\ block\ of\ T\ to\ positive\ diagonal\ form\ using\ 2x2\ SVD.}}
\DoxyCodeLine{00621\ \ \ \ \ \ \ \textcolor{comment}{//\ This\ step\ is\ not\ mandatory\ for\ QZ,\ but\ it\ does\ help\ further\ extraction\ of\ eigenvalues/eigenvectors,}}
\DoxyCodeLine{00622\ \ \ \ \ \ \ \textcolor{comment}{//\ and\ is\ in\ par\ with\ Lapack/Matlab\ QZ.}}
\DoxyCodeLine{00623\ \ \ \ \ \ \ \textcolor{keywordflow}{if}(m\_info==\mbox{\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea671a2aeb0f527802806a441d58a80fcf}{Success}})}
\DoxyCodeLine{00624\ \ \ \ \ \ \ \{}
\DoxyCodeLine{00625\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}(\mbox{\hyperlink{class_eigen_1_1_real_q_z_a6201e534e901b5f4e66f72c176b534a3}{Index}}\ i=0;\ i<dim-\/1;\ ++i)}
\DoxyCodeLine{00626\ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00627\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(m\_S.coeff(i+1,\ i)\ !=\ Scalar(0))}
\DoxyCodeLine{00628\ \ \ \ \ \ \ \ \ \ \ \{}
\DoxyCodeLine{00629\ \ \ \ \ \ \ \ \ \ \ \ \ \mbox{\hyperlink{class_eigen_1_1_jacobi_rotation}{JacobiRotation<Scalar>}}\ j\_left,\ j\_right;}
\DoxyCodeLine{00630\ \ \ \ \ \ \ \ \ \ \ \ \ internal::real\_2x2\_jacobi\_svd(m\_T,\ i,\ i+1,\ \&j\_left,\ \&j\_right);}
\DoxyCodeLine{00631\ }
\DoxyCodeLine{00632\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{comment}{//\ Apply\ resulting\ Jacobi\ rotations}}
\DoxyCodeLine{00633\ \ \ \ \ \ \ \ \ \ \ \ \ m\_S.applyOnTheLeft(i,i+1,j\_left);}
\DoxyCodeLine{00634\ \ \ \ \ \ \ \ \ \ \ \ \ m\_S.applyOnTheRight(i,i+1,j\_right);}
\DoxyCodeLine{00635\ \ \ \ \ \ \ \ \ \ \ \ \ m\_T.applyOnTheLeft(i,i+1,j\_left);}
\DoxyCodeLine{00636\ \ \ \ \ \ \ \ \ \ \ \ \ m\_T.applyOnTheRight(i,i+1,j\_right);}
\DoxyCodeLine{00637\ \ \ \ \ \ \ \ \ \ \ \ \ m\_T(i+1,i)\ =\ m\_T(i,i+1)\ =\ Scalar(0);}
\DoxyCodeLine{00638\ }
\DoxyCodeLine{00639\ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{if}(m\_computeQZ)\ \{}
\DoxyCodeLine{00640\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_Q.applyOnTheRight(i,i+1,j\_left.\mbox{\hyperlink{class_eigen_1_1_jacobi_rotation_ab40e9cdc4582593511e57ee896e055a2}{transpose}}());}
\DoxyCodeLine{00641\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ m\_Z.applyOnTheLeft(i,i+1,j\_right.\mbox{\hyperlink{class_eigen_1_1_jacobi_rotation_ab40e9cdc4582593511e57ee896e055a2}{transpose}}());}
\DoxyCodeLine{00642\ \ \ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00643\ }
\DoxyCodeLine{00644\ \ \ \ \ \ \ \ \ \ \ \ \ i++;}
\DoxyCodeLine{00645\ \ \ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00646\ \ \ \ \ \ \ \ \ \}}
\DoxyCodeLine{00647\ \ \ \ \ \ \ \}}
\DoxyCodeLine{00648\ }
\DoxyCodeLine{00649\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ *\textcolor{keyword}{this};}
\DoxyCodeLine{00650\ \ \ \ \ \}\ \textcolor{comment}{//\ end\ compute}}
\DoxyCodeLine{00651\ }
\DoxyCodeLine{00652\ \}\ \textcolor{comment}{//\ end\ namespace\ Eigen}}
\DoxyCodeLine{00653\ }
\DoxyCodeLine{00654\ \textcolor{preprocessor}{\#endif\ }\textcolor{comment}{//EIGEN\_REAL\_QZ}}

\end{DoxyCode}
